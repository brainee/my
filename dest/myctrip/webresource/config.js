!function(){var e=!Lizard.isHybrid&&$(window).width()>767&&location.search.indexOf("for=test")>-1;window.loadModule=function(t,i){return i?"online"===i&&e?t+"_online":"h5"===i?t+"_h5":"":t+(e?"_online":"_h5")},Lizard.isHybrid||-1!==location.search.indexOf("debug=1")||require(["/webapp/myctrip/dest/webresource/"+(e?"onlineconfig.js":"h5config.js")])}(),define(["../../basewidget/main.js"],function(){var e="webresource/",t="undefined"!=typeof location&&-1!=location.search.indexOf("debug=1"),i={paths:{myctripCommon:e+"common/myctrip.common",indexCommon:e+"common/index.common",MyCtripModel:e+"models/myctripmodel",MyCtripStore:e+"models/myctripstore",cardloader:e+"views/orders/cards/cardloader",basecard:e+"views/orders/cards/basecard",activitycard:e+"views/orders/cards/activitycard",airbuscard:e+"views/orders/cards/airbuscard",carcard:e+"views/orders/cards/carcard",cruisecard:e+"views/orders/cards/cruisecard",diycard:e+"views/orders/cards/diycard",flightcard:e+"views/orders/cards/flightcard",globalbuycard:e+"views/orders/cards/globalbuycard",golfcard:e+"views/orders/cards/golfcard",hhtravelcard:e+"views/orders/cards/hhtravelcard",hotelcard:e+"views/orders/cards/hotelcard",insurecard:e+"views/orders/cards/insurecard",sceneryhotelcard:e+"views/orders/cards/sceneryhotelcard",lipincard:e+"views/orders/cards/lipincard",mallcard:e+"views/orders/cards/mallcard",piaocard:e+"views/orders/cards/piaocard",qichecard:e+"views/orders/cards/qichecard",taxicard:e+"views/orders/cards/taxicard",topshopcard:e+"views/orders/cards/topshopcard",traincard:e+"views/orders/cards/traincard",tuancard:e+"views/orders/cards/tuancard",vacationcard:e+"views/orders/cards/vacationcard",visacard:e+"views/orders/cards/visacard",depositcard:e+"views/orders/cards/depositcard",dnrcard:e+"views/orders/cards/dnrcard",commonlist:e+"views/orders/commonlist",template:e+"views/orders/cards/template.html",indexTpl_online:e+"views/indexTpl_online.html",orderTypes_h5:e+"components/h5/ordertypes",orderTypes_online:e+"components/online/ordertypes",pagination_online:e+"components/online/pagination"}};t&&(i.urlArgs=Date.now()),require.config(i)}),define("myctripCommon",["CommonStore","cLocalStorage","cHybridShell","cUtilCommon","cGuiderService"],function(e,t,i,a,r){String.prototype.toDate||(String.prototype.toDate=function(e){var t=6e4*(new Date).getTimezoneOffset()+60*(e?e:0)*6e4;if(isNaN(this)){var i=this.replace(/\D/gim,"").substring(0,13),a=new Date(parseInt(i)+t);return a}return this}),Date.prototype.ZoneDate||(Date.prototype.ZoneDate=function(e){var t=6e4*(new Date).getTimezoneOffset()+60*(e?e:0)*6e4,i=this.getTime(),a=new Date(i+t);return a});var n={isInApp:a.isInApp,isOnline:0===deviceEnv,isPad:a.isInApp?10===deviceEnv:11===deviceEnv,isMobile:a.isInApp?20===deviceEnv:21===deviceEnv,checkLogin:function(){var t=e.UserStore.getInstance(),i=t?t.getUser():null;return i&&i.Auth&&!i.IsNonUser?1:i&&i.Auth&&i.IsNonUser?2:0},isJoinMobileSearch:function(e){var t=["hotel","tuan"];return e="string"==typeof e?e.toLowerCase():"",!this.isInApp&&t.indexOf(e)>-1},isunlogin:function(e){var t=this.checkLogin();return!this.isInApp&&t&&2===t&&this.isJoinMobileSearch(e)?!0:!1},isTieYou:function(){var e=Lizard.P("istieyou")||localStorage.getItem("isTieYou");return"true"==e?(localStorage.setItem("isTieYou",!0),!0):(localStorage.removeItem("isTieYou"),!1)},getOrderTypeList:function(e){var t=[{flag:3,name:"全部订单",classname:"o-all",biztype:"All",url:"orders/allorders"},{flag:3,name:"酒店订单",classname:"o-hotel",biztype:"Hotel",url:"orders/hotelorderlist"},{flag:3,name:"机票订单",classname:"o-flight",biztype:"Flight",url:"orders/flightorderlist"},{flag:3,name:"火车票订单",classname:"o-train",biztype:"Train",url:"orders/trainorderlist"},{flag:3,name:"旅游度假订单",classname:"o-team",biztype:["Cruise","DIY","Vacation"],url:"orders/vacationunionorderlist"},{flag:3,name:"团购订单",classname:"o-tuan",biztype:"Tuan",url:"orders/tuanorderlist"},{flag:3,name:"景点门票订单",classname:"o-ticket",biztype:"Piao",url:"orders/ticketsorderlist"},{flag:3,name:"当地玩乐订单",classname:"o-event",biztype:"Activity",url:"orders/localeventorderlist"},{flag:1,name:"用车订单",classname:"o-car",biztype:["Car","CarTaxi"],url:"orders/carunionorderlist"},{flag:3,name:"酒店+景点订单",classname:"o-spots",biztype:"SceneryHotel",url:"orders/sceneryhotelorderlist"},{flag:1,name:"签证订单",classname:"o-visa",biztype:"Visa",url:"orders/visaorderlist"},{flag:3,name:"礼品卡订单",classname:"o-gcard",biztype:"Lipin",url:"orders/travelticketorderlist"},{flag:1,name:"高端商户订单",classname:"o-food",biztype:"TopShop",url:"orders/topshoporderlist"},{flag:2,name:"美食订餐订单",classname:"o-dnr",biztype:"Dnr",url:"orders/dnrorderlist"},{flag:3,name:"汽车票订单",classname:"o-bus",biztype:"QiChe",url:"orders/busorderlist"},{flag:3,name:"保险订单",classname:"o-insurance",biztype:"VacationInsurance",url:"orders/insureorderlist"},{flag:3,name:"高尔夫订单",classname:"o-golf",biztype:"Golf",url:"orders/golforderlist"},{flag:3,name:"机场巴士订单",classname:"o-airportbus",biztype:"AirportBus",url:"orders/airportbusorderlist"},{flag:3,name:"HHTravel订单",classname:"o-hhtravel",biztype:"HHTravel",url:"orders/hhtravelorderlist"},{flag:1,name:"礼遇商城订单",classname:"o-gcardmall",biztype:"Mall",url:"orders/mallorderlist"},{flag:3,name:"全球购订单",classname:"o-global",biztype:"GlobalBuy",url:"orders/globalbuyorderlist"},{flag:2,name:"存款证明订单",classname:"o-certificate",biztype:"Deposit",url:"orders/depositorderlist"}];return e="undefined"==typeof e||e===!1?!1:!0,t=$.grep(t,function(t){if(e){if(2===t.flag||3===t.flag)return!0}else if(1===t.flag||3===t.flag)return!0})},sendUbtTrace:function(e){if(a.isInApp){var t=["traceName","pageId","pageName","bServerError","err"];t.forEach(function(t){e.hasOwnProperty(t)&&void 0===e[t]});var n="allorders"===e.pageName?!0:!1,s={pageName:e.pageName,pageId:e.pageId};e.bServerError?(s.msg=JSON.stringify(e.err),i.Fn("send_ubt_trace").run(e.traceName,s)):r.app_check_network_status({callback:function(t){if(t&&t.hasNetwork)s.msg="Abort error";else{if(n)return;s.msg="Network error"}i.Fn("send_ubt_trace").run(e.traceName,s)}})}},apply:function(e){var t=0===deviceEnv;e&&"object"==typeof e&&(t?e.onlineCallback&&"function"==typeof e.onlineCallback&&e.onlineCallback():(delete e.onlineCallback,r.apply(e)))}};return n}),define("MyCtripStore",["cStore","cCoreInherit"],function(e,t){var i={};return i.FlightOrderParamStore=new t.Class(e,{__propertys__:function(){this.key="USER_FLIGHT_ORDERPARAM",this.lifeTime="1D",this.isUserData=!0},initialize:function($super,e){$super(e)}}),i.FltintlOrderId=new t.Class(e,{__propertys__:function(){this.key="fltintlOrderId",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),i.CustomerNoticesListStore=new t.Class(e,{__propertys__:function(){this.key="MYCTRIP_NOTICES_LIST",this.lifeTime="3M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),i.CustomerNoticesDateStore=new t.Class(e,{__propertys__:function(){this.key="MYCTRIP_NOTICES_DATE",this.lifeTime="365D"},initialize:function($super,e){$super(e)}}),i.CustomerNoticesDetailStore=new t.Class(e,{__propertys__:function(){this.key="MYCTRIP_NOTICES_DETAIL",this.lifeTime="1D"},initialize:function($super,e){$super(e)}}),i.CustomerHotelOrderId=new t.Class(e,{__propertys__:function(){this.key="CUSTOMER_HOTELORDER_ID",this.lifeTime="5H"},initialize:function($super,e){$super(e)}}),i.UnreadMessageNumStore=new t.Class(e,{__propertys__:function(){this.key="UNREAD_MESSAGE_NUM",this.lifeTime="1M",this.isUserData=!0},initialize:function($super,e){$super(e)}}),i.GetMessageListStore=new t.Class(e,{__propertys__:function(){this.key="MESSAGE_LIST",this.lifeTime="2S",this.isUserData=!0},initialize:function($super,e){$super(e)}}),i.OrderlistBackStore=new t.Class(e,{__propertys__:function(){this.key="ORDERLIST_BACK",this.lifeTime="1D",this.isUserData=!0},initialize:function($super,e){$super(e)}}),i}),define("MyCtripModel",["cModel","cCoreInherit","MyCtripStore","cUtilCommon","CommonStore"],function(e,t,i,a,r){var n={},s=(r.UserStore.getInstance().getUser()||{},new t.Class(e,{__propertys__:function(){this.param={ClientVersion:"6.4",Channel:0===window.deviceEnv?"Online":a.isInApp?"Hybrid":"H5"}},initialize:function(){},buildurl:function(){var e=this.baseurl(),t=e.domain+"/"+e.path+("function"==typeof this.url?this.url():this.url);return t},baseurl:function(){var e=(location.host,"m.ctrip.com"),t="restapi",i={https:{damain:Lizard.restfullApiHttps,path:"restapi"},http:{common:{domain:Lizard.restfullApi,path:"restapi"},gateway:{domain:Lizard.restfullApi,path:"restapi"}}},a=this.protocol||location.protocol;return e=i[a][this["interface"]||"common"].domain,t=i[a][this["interface"]||"common"].path,{domain:e,path:t}}})),o=new t.Class(e,{__propertys__:function(){},initialize:function(){},buildurl:function(){return this.url}});return n.SendValidateCodeModel=new t.Class(o,{__propertys__:function(){this.method="POST",this.datatype="json",this.url="/html5/ClientData/ValidVerifyCode/json",this.param={}}}),n.GetPicValCodeModel=new t.Class(o,{__propertys__:function(){this.method="POST",this.datatype="json",this.url="/html5/ClientData/GetVerifyCode/",this.param={}}}),n.CheckVerifyCodeModel=new t.Class(o,{__propertys__:function(){this.method="POST",this.datatype="json",this.url="/html5/Custom/CheckVerifyCode",this.param={}}}),n.FlightCancelModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10400/Basic/Order/Cancel",this.method="POST",this.param={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.CustomerNoticesListModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10060/GetNoticeInfo.json",this.method="POST",this["interface"]="gateway",this.debug=!1,this.param={PublishDate:"1970-01-01 01:01:01",NoticeType:1},this.result=i.CustomerNoticesListStore.getInstance(),this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.CustomeFeedbackModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10060/AddFeedbackInfo.json",this["interface"]="gateway",this.debug=!1,this.method="POST",this.param={BusinessType:201,Feedback:"",Mobilephone:"",SendDisplayName:"",SendEMailAddress:""},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.CustomerHotelOrderCancelModel=new t.Class(s,{__propertys__:function(){this.param={ver:1,oid:0,reason:""},this.isUserData=!0,this["interface"]="gateway",this.method="POST",this.url="/soa2/10324/hotel/order/cancel"},initialize:function($super,e){$super(e)}}),n.HideOrderModel=new t.Class(s,{__propertys__:function(){this.isUserData=!0,this.datatype="json",this["interface"]="gateway",this.method="POST",this.url="/soa2/10098/HideOrders.json"},initialize:function($super,e){$super(e)}}),n.CustomerHotelOrderUrgentModel=new t.Class(s,{__propertys__:function(){this.isUserData=!0,this.datatype="json",this["interface"]="gateway",this.method="POST",this.url="/soa2/10098/HandleHotelOrderReminder.json"},initialize:function($super,e){$super(e)}}),n.TuanOrderCancelModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10101/OrderCancel.json",this["interface"]="gateway",this.method="POST",this.isUserData=!0,this.param={oid:0}},initialize:function($super,e){$super(e)}}),n.TuanOrderDeleteModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10101/OrderDelete.json",this["interface"]="gateway",this.method="POST",this.isUserData=!0,this.param={oid:0}},initialize:function($super,e){$super(e)}}),n.AirportbusCancelModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10440/cancelorder.json",this.method="POST",this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.GlobalBuyCancelModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10419/UpdateOrderStatus.json",this.method="POST",this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.CustomerLipinConfirmModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10140/restfulconfirmgoods.json",this.method="POST",this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.CustomerTaxiListModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10098/GetTaxiOrders.json",this.method="POST",this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.TopShopCancelModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10267/AppMyCtripOrderCancel.json",this.method="POST",this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.OrdersSearchModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10098/GetOrdersSearch.json",this.method="POST",this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.OrderNumbersModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10098/GetOrderNumbers.json",this.method="POST",this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.UserInfoModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10098/GetMemberSummaryInfo.json",this["interface"]="gateway",this.method="POST"},initialize:function($super,e){$super(e)}}),n.OrderStatusModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10098/getmemberorderstatistics.json",this["interface"]="gateway",this.method="POST"},initialize:function($super,e){$super(e)}}),n.UnreadMessageNumModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10364/GetMessageLists.json",this.method="POST",this.param={ChannelType:"H5",BizType:"ALL",MessageTab:"NULL",MessageStatus:"NULL",Operate:1},this["interface"]="gateway"},initialize:function($super,e){$super(e)}}),n.LipinAbandonRebateModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10098/handlelipinorderabandonrebate.json",this.method="POST",this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.OrderPaymentModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10098/HandleOrderPayment.json",this.method="POST",this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.CruiseCancelOrderModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10184/CancelOrder.json",this["interface"]="gateway",this.method="POST",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.TicketCancelOrderModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10131/OrderManagementQOC.json",this.method="POST",this.param={oid:0,reason:"行程不确定",optype:"1"},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.TicketSendMessageModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10131/SendMessageQOC.json",this.method="POST",this.param={oid:0,mbi:0},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.ActivityCancelOrderModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10220/OrderManagement.json",this.method="POST",this.param={oid:0,reason:"行程不确定",optype:"1"},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.ActivitySendMessageModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10220/SendMessage.json",this.method="POST",this.param={oid:0,mbi:0},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.ValidateAndGetNewTokenModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10093/ValidateAndGetNewToken.json",this.method="POST",this.param={},this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.ValidateWechatBindModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10060/WeiXinLogin.json",this.method="POST",this.param={},this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.AutoCreateAccountModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10060/WeiXinRegister.json",this.method="POST",this.param={},this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.RefreshRelationModel=new t.Class(s,{__propertys__:function(){this.debug=!1,this.url="/soa2/10060/WeiXinBind.json",this.method="POST",this.param={},this["interface"]="gateway",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.XiaomiAccountBindModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10060/MiLogin.json",this["interface"]="gateway",this.param={},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.UnLoginCheckModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10261/validatemobilephone.json",this.param={ver:0,AppID:100},this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.UnLoginGetOrderModel=new t.Class(s,{__propertys__:function(){this.url="/soa2/10098/GetOrderByMobile.json",this.isUserData=!0},initialize:function($super,e){$super(e)}}),n.favoriteModel=new t.Class(s,{__propertys__:function(){this.isUserData=!0,this.datatype="json",this["interface"]="gateway",this.method="POST",this.url="/soa2/10279/json/GetMyFavorites"},initialize:function($super,e){$super(e)}}),n.BasicConfInfoModel=new t.Class(s,{__propertys__:function(){this.isUserData=!1,this.datatype="json",this["interface"]="gateway",this.method="POST",this.url="/soa2/10606/GetBasicConfInfo.json"},initialize:function($super,e){$super(e)}}),n.AppUpdateServiceModel=new t.Class(s,{__propertys__:function(){this.isUserData=!1,this.datatype="json",this["interface"]="gateway",this.method="POST",this.url="/soa2/10348/GetAppUpdateInfo.json"},initialize:function($super,e){$super(e)}}),n.GetMessageListsModel=new t.Class(s,{__propertys__:function(){this.isUserData=!0,this.datatype="json",this["interface"]="gateway",this.method="POST",this.url="/soa2/10612/GetMessageList.json",this.param={MsgType:"SERVICE",Status:"NEW",SortType:"TIME_DESC",Options:"CONTENT_SUMMARY",StartTime:"1970/1/1",StartIndex:0,MaxRecords:50},this.result=i.GetMessageListStore.getInstance()},initialize:function($super,e){$super(e)}}),n.CancelOrder=new t.Class(s,{__propertys__:function(){this.isUserData=!1,this.datatype="json",this["interface"]="gateway",this.method="POST",this.url="/soa2/10487/CancelOrder.json"},initialize:function($super,e){$super(e)}}),n.RecedeOrder=new t.Class(s,{__propertys__:function(){this.isUserData=!1,this.datatype="json",this["interface"]="gateway",this.method="POST",this.url="/soa2/10487/RecedeOrder.json"},initialize:function($super,e){$super(e)}}),n}),define("text!template",[],function(){return'<script type="text/template" id="Activity"><%var timeContent=isWifi?UsageDate[0]+"&nbsp;至&nbsp;"+ExpiredDate[0]:UsageDate[0]+"出发";%><li data-oid="<%=OrderID%>" data-actions="<%=actions%>" <%if(typeof ContactMobile != \'undefined\'){%>data-mobile="<%=ContactMobile%>" <%}%>class="order-list-item activity <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-event">当地玩乐</span> <%}%> <span class="order-status<%=OrderStatusName.indexOf(\'成交\') > -1 ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=ActivityOrderItems[0].ProductName%></h2><p class="order-info"><%=timeContent%></p></div><%=btnhtml%></li></script><script type="text/template" id="Car"><li class="order-list-item car <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-car">用车</span> <%}%> <span class="order-status<%=OrderStatusName==\'已成交\'?\' order-status-succes\':\'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=CarOrderItems[0]["UsageCity"]%>/<%=CarOrderItems[0]["ProductName"]%></h2><p class="order-info"><%=UsageDate[0]%>使用</p></div><%=btnhtml%></li></script><script type="text/template" id="Cruise"><li class="order-list-item cruise <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-cruise">邮轮</span> <%}%> <span class="order-status <%=OrderStatusName===\'已成交\' ? \'order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=CruiseOrderItems[0].ProductName%></h2><p class="order-info"><%=UsageDate[0]%>出发</p></div><%=btnhtml%></li></script><script type="text/template" id="DIY"><li class="order-list-item diy <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-visit">自由行</span> <%}%> <span class="order-status <%=OrderStatusName===\'已成交\' ? \'order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><%if(DIYOrderItems&&DIYOrderItems[0]){%><h2 class="ellips_line2"><%=DIYOrderItems[0].ProductName.split("|")[0]%></h2><%}%><p class="order-info"><%=BeginUsageDate[0]%>&nbsp;至&nbsp;<%=EndUsageDate[0]%></p></div><%=btnhtml%></li></script><script type="text/template" id="Flight"><li class="order-list-item flight <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-type="<%=BizType%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(viewType=="flightorderlist" || (viewType=="searchresult"&&!bAllSearch)){%> <span class="order-type single-order-type"><%=orderType%></span> <%}else{%> <span class="order-type type-flight">机票</span> <%}%> <span class="order-status <%=OrderStatusName===\'已成交\' ? \'order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><div class="travel-wrap flight-wrap <%=isSingleTrip ? \'flight-single\' : (isTypeReturn ? \'flight-return\' : \'flight-transit\')%>"><h2 class="ellips_line2"><%=depFlightInfo.DepartureDisplayName%>&nbsp;-&nbsp;<%=isTypeReturn&&isUnAbandon ? arrFlightInfo.DepartureDisplayName : arrFlightInfo.ArrivalDisplayName%><%if(isFlightAndTrain){%>（空铁组合）<%}%><%if(isConnecting){%>（联程）<%}%><%if(isTypeReturn){%>（往返）<%}%></h2><%if(isFlightAndTrain){%> <%=flightAndTrainHtml%> <%}else{%><p class="order-info"><%if(isTypeReturn){%><span class="start">去</span><%}%> <span class="date"><%=DepartureDate[0]%></span><span class="hour"><%=DepartureDate[1]%>&nbsp;至&nbsp;<%=DepartureDate[0]==ArrivalDate[0]?\'\':ArrivalDate[0]+\' \'%><%=ArrivalDate[1]%></span> <span class="item"><%=depFlightInfo.FlightNo + (isTypeReturn ? (timeIndexes[1] > 0 ? \'等\' : \'\') : (FlightOrderItems.length > 1 ? \'等\' : \'\'))%></span></p><%if (isTypeReturn&&isUnAbandon){%><p class="order-info"><%if(isTypeReturn){%><span class="end">返</span><%}%> <span class="date"><%=BackDepartureDate[0]%></span><span class="hour"><%=BackDepartureDate[1]%>&nbsp;至&nbsp;<%=BackDepartureDate[0]==BackArrivalDate[0]?\'\':BackArrivalDate[0]+\' \'%><%=BackArrivalDate[1]%></span> <span class="item"><%=arrFlightInfo.FlightNo + (timeIndexes[3] > timeIndexes[2] ? \'等\' : \'\')%></span></p><%}%> <%}%></div></div><%var orderActions = (OrderActions instanceof Array) ? OrderActions : []; if(orderActions.length > 0){%> <%=btnhtml%> <%}%></li></script><script type="text/template" id="Golf"><li class="order-list-item golf <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-golf">高尔夫</span> <%}%> <span class="order-status <%=OrderStatusName==\'支付成功\' ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=OrderName%></h2><p class="order-info"><%=UsageDate[0]%>&nbsp;&nbsp;使用</p></div><%=btnhtml%></li></script><script type="text/template" id="Hotel"><li class="order-list-item hotel <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-share="<%=shareItem%>" data-hotelid="<%=HotelOrderItems[0].HotelID%>" data-oid="<%=OrderID%>" data-name="<%=HotelOrderItems[0].ProductName%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(viewType=="hotelorderlist" || (viewType=="searchresult"&&!bAllSearch)){%> <span class="order-type single-order-type"><%=orderType%></span> <%}else{%> <span class="order-type type-hotel">酒店</span> <%}%> <span class="order-status <%=OrderStatusName==\'已成交\' ? " order-status-succes":""%>"><%=OrderStatusName%></span> <%if(Currency=="CNY"||Currency=="RMB"){%> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span> <%}else{%> <span class="order-price"><dfn><%=Currency%></dfn><%=OrderTotalPrice%></span> <%}%></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=HotelOrderItems[0].ProductName%></h2><p class="order-info"><%=HotelOrderItems[0][\'HotelAddress\']?HotelOrderItems[0][\'HotelAddress\']:\'\'%></p><p class="order-info"><%=CheckInDate[0]%>&nbsp;至&nbsp;<%=CheckOutDate[0]%>&nbsp;&nbsp;<%=HotelOrderItems[0].NightAmount%>晚/<%=HotelOrderItems[0].RoomAmount%>间</p></div><%=btnhtml%></li></script><script type="text/template" id="VacationInsurance"><li class="order-list-item vacationinsurance <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(viewType!=="insureorderlist"){%> <span class="order-type type-insure">保险</span> <%}%> <span class="order-status<%=OrderStatusName==\'已出保\' ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=OrderName%></h2><p class="order-info"><%=EffectDate[0]%>&nbsp;至&nbsp;<%=ExpiredDate[0]%>&nbsp;<%=VacationInsuranceOrderItems[0].InsuredDays%>天/<%=VacationInsuranceOrderItems[0].InsuredCount%>单</p></div><%=btnhtml%></li></script><script type="text/template" id="SceneryHotel"><li class="order-list-item sceneryhotel <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type attractions-hotels">酒店+景点</span> <%}%> <span class="order-status <%=OrderStatusName===\'已成交\' ? \'order-status-succes\' : \'\'%>"><%=OrderStatusName?OrderStatusName:""%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=OrderName?OrderName:""%></h2><p class="order-info"><%=DepartureDate[0]%>&nbsp;出发</p></div><%=btnhtml%></li></script><script type="text/template" id="Lipin"><li class="order-list-item lipin <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-onum="<%=orderInfo.OrderNumber%>" data-cnt="<%=orderInfo.Quantity%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-lipin">礼品卡</span> <%}%> <span class="order-status"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=orderInfo.ProductName%></h2><p class="order-info"><%=orderInfo.ProductTypeName%>&nbsp;-&nbsp;<%=orderInfo.DeliverTypeName%>&nbsp;&nbsp;<%=orderInfo.Quantity ? orderInfo.Quantity + \'张\' : \'\'%></p></div><%=btnhtml%></li></script><script type="text/template" id="Piao"><li class="order-list-item piao <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-mobile="<%=typeof ContactMobile==\'undefined\' ? \'\' : ContactMobile%>" data-actions="<%=actions%>" data-url="<%=ActionURLH5%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-ticket">门票</span> <%}%> <span class="order-status<%=OrderStatusName.indexOf(\'成交\') > -1 ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=typeof ProductName==\'undefined\' ? OrderName : ProductName%></h2><p class="order-info"><%=DepartureDate[0]%>使用&nbsp;&nbsp;<%=PiaoOrderItems[0].Quantity%>张</p></div><%=btnhtml%></li></script><script type="text/template" id="QiChe"><li class="order-list-item qiche <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-bus">汽车票</span> <%}%> <span class="order-status<%=OrderStatusName==\'已成交\'? \' order-status-succes\':\'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><div class="travel-wrap car-wrap"><h2 class="ellips_line2"><%=depQicheInfo.departureDisplayName%>&nbsp;-&nbsp;<%=depQicheInfo.arrivalDisplayName%></h2><%if (depQicheInfo.ArriveTime){%><p class="order-info"><span class="date"><%=DepartureDate[0]%></span><span class="hour"><%=DepartureDate[1]%>&nbsp;至&nbsp;<%=(DepartureDate[0]==depQicheInfo.ArriveTime[0])?\'\':depQicheInfo.ArriveTime[0]+\' \'%><%=depQicheInfo.ArriveTime[1]%></span></p><%}else{%><p class="order-info"><span class="date"><%=DepartureDate[0]%></span><span class="hour"><%=DepartureDate[1]%>&nbsp;至&nbsp;</span><span class="hour">--</span></p><%}%> <%if (depQicheInfo.FetcherCode){%><p class="order-tip">取票号: <%=depQicheInfo.FetcherCode%></p><%}%> <%if (depQicheInfo.FetcherPassword){%><p class="order-tip">取票密码: <%=depQicheInfo.FetcherPassword%></p><%}%> <%if (depQicheInfo.FetcherOrderID){%><p class="order-tip">取票订单号: <%=depQicheInfo.FetcherOrderID%></p><%}%></div></div><%=btnhtml%></li></script><script type="text/template" id="Taxi"><li class="order-list-item car <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-car">用车</span> <%}%> <span class="order-status<%=OrderStatusName==\'已成交\'? \' order-status-succes\':\'\'%>"><%=OrderStatusName%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=OrderName%></h2><p class="depart-date"><%=UsageDate ? UsageDate[0] : ""%>使用</p></div><%=btnhtml%></li></script><script type="text/template" id="TopShop"><li class="order-list-item topshop <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-food">高端商户</span> <%}%> <span class="order-status<%=OrderStatusName==\'支付成功\' ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=orderInfo.ProductName%></h2><p class="order-info"><%=BeginValidTime[0]%>&nbsp;至&nbsp;<%=EndValidTime[0]%>&nbsp;<%=orderInfo.ProductCount%>张</p><p class="order-tip"><%=(OrderStatusName==\'支付成功\'&&orderInfo.VerificationCodeOverview) ? orderInfo.VerificationCodeOverview : \'\'%></p></div><%=btnhtml%></li></script><script type="text/template" id="Train"><li class="order-list-item train <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-share="<%=shareItem%>" data-oid="<%=OrderID%>" data-type="<%=BizType%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(viewType=="trainorderlist"){%> <span class="order-type single-order-type"><%=orderType%></span> <%}else{%> <span class="order-type type-train">火车票</span> <%}%> <span class="order-status <%=OrderStatusName===\'已成交\' ? \'order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><%if(BizType=="Train"){%><h2 class="ellips_line2"><%=depTrainInfo.DepartureStation%>&nbsp;-&nbsp;<%=depTrainInfo.ArrivalStation%></h2><p class="order-info"><span class="date"><%=DepartureDate[0]%></span><span class="hour"><%=DepartureDate[1]%>&nbsp;至&nbsp;<%=(DepartureDate[0]==ArrivalDate[0]) ? \'\' : ArrivalDate[0] + \' \'%><%=ArrivalDate[1]%></span> <%if (carriageSeat.length > 0){%> <span class="item seat<%=isTypeReturn ? \' seat-round\' : \'\'%>"><%=depTrainInfo.TrainNumber + \' \' + carriageSeat%></span> <%}else{%> <span class="item"><%=depTrainInfo.TrainNumber%></span> <%}%></p><%if (depTrainInfo.TicketWindow){%><p class="order-tip">窗口取票号:<%=depTrainInfo.TicketWindow%></p><%}%> <%}else{%><h2 class="ellips_line2"><%=OrderName%></h2><%if (depTrainInfo.Validity){%><p class="order-info"><%=depTrainInfo.Validity%></p><%}else{%><p class="order-info"><%if (isTypeReturn){%><span class="start">去</span><%}%> <span class="date"><%=DepartureDate[0]%></span><span class="hour"><%=DepartureDate[1]%>&nbsp;至&nbsp;<%=(DepartureDate[0]==ArrivalDate[0]) ? \'\' : ArrivalDate[0] + \' \'%><%=ArrivalDate[1]%></span> <span class="item"><%=depTrainInfo.TrainNumber + (timeIndexes[1] > 0 ? \'等\' : \'\')%></span></p><%if (isTypeReturn){%><p class="order-info"><span class="end">返</span> <span class="date"><%=BackDepartureDate[0]%></span><span class="hour"><%=BackDepartureDate[1]%>&nbsp;至&nbsp;<%=(BackDepartureDate[0]==BackArrivalDate[0]) ? \'\' : BackArrivalDate[0] + \' \'%><%=BackArrivalDate[1]%></span> <span class="item"><%=arrTrainInfo.TrainNumber + (timeIndexes[3] > timeIndexes[2] ? \'等\' : \'\')%></span></p><%}%> <%}%> <%}%></div><%=btnhtml%></li></script><script type="text/template" id="Tuan"><li class="order-list-item tuan <%=OrderStatusName===\'已经取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-tuan">团购</span> <%}%> <span class="order-status"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=TuanOrderItems[0].ProductName ? TuanOrderItems[0].ProductName : ""%></h2><p class="order-info"><%if(RobType&&RobType==\'Y\'){%> <%=TakeEffectDate[0]?TakeEffectDate[0]:""%>&nbsp;使用&nbsp;&nbsp; <%}else if(ExpireDate[0].indexOf(\'2050\') < 0){%> 有效期至&nbsp;<%=ExpireDate[0]?ExpireDate[0]:""%>&nbsp;&nbsp; <%}%></p><%if(TicketStatusesDesc){%><p class="order-tip"><%=TicketStatusesDesc%></p><%}%></div><%=btnhtml%></li></script><script type="text/template" id="Vacation"><li class="order-list-item vacation <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-share="<%=shareItem%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-team">旅游</span> <%}%> <span class="order-status <%=OrderStatusName===\'已成交\' ? \'order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%-detail%>"><h2 class="ellips_line2"><%=OrderName%></h2><p class="order-info"><%=DepartureDate[0]%>出发</p></div><%=btnhtml%></li></script><script type="text/template" id="Visa"><li class="order-list-item visa <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-visa">签证</span> <%}%> <span class="order-status<%=OrderStatusCode==\'已成交\' ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=OrderName%></h2><p class="depart-date"><%=DepartureDate[0]%>&nbsp;出发</p></div><%=btnhtml%></li></script><script type="text/template" id="AirportBus"><li class="order-list-item airportbus <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-airportbus">机场巴士</span> <%}%> <span class="order-status<%=OrderStatusName===\'已出票\' ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=OrderName%></h2><p class="order-info"><span class="date"><%=depAirbusInfo.UsageDate%></span> <span class="item"><%=depAirbusInfo.BusNo%></span></p><%if (TicketNumber){%><p class="order-tip">取票号: <%=TicketNumber%></p><%}%></div><%=btnhtml%></li></script><script type="text/template" id="HHTravel"><li class="order-list-item hhtravel <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-hhtravel">HHTravel</span> <%}%> <span class="order-status<%=OrderStatusName===\'已成交\' ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=OrderTotalPrice%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=OrderName%></h2><p class="order-info"><%=UsageDate[0]%>&nbsp;&nbsp;出发</p></div></li></script><script type="text/template" id="Mall"><li class="order-list-item mall <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-gcardmall">礼遇商城</span> <%}%> <span class="order-status<%=OrderStatusName===\'已成交\' ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn><%=(Currency===\'RMB\' || Currency===\'CNY\') ? \'&yen;\' : Currency%></dfn><%=OrderTotalPrice%><span class="order-integral">+<em><%=Point%></em>积分</span></span></div><div class="order-cont order-cont-img" data-url="<%=detail%>"><div class="order-img"><span><img src="<%=ImageURL%>" alt=""></span></div><div class="order-cont-title"><h2><%=ProductName%></h2></div><p class="order-tip"><%=ProductDesc%> 数量:<%=Quantity%></p></div><%=btnhtml%></li></script><script type="text/template" id="GlobalBuy"><li class="order-list-item globalbuy <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-global">全球购</span> <%}%> <span class="order-status<%=OrderStatusName===\'待支付\' ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn><%=(Currency===\'RMB\' || Currency===\'CNY\') ? \'&yen;\' : Currency%></dfn><%=OrderTotalPrice%></span></div><div class="order-cont order-cont-img order-cont-img-notip" data-url="<%=detail%>"><h3><%=SiteName%>-<%=VendorName%></h3><span class="piece">共<%=total%>件</span> <%if(isMultiple){%><div class="order-img scroll-img-area"><div class="scroll-img-list"><%for(var i = 0, len = Quantity > 3 ? 3 : Quantity; i < len; i++){%> <span><img src="<%=items[i].ImageUrl%>" alt=""></span> <%}%></div></div><%}else{%><div class="order-img"><span><img src="<%=items[0].ImageUrl%>" alt=""></span></div><div class="order-cont-title"><h2><%=items[0].ProductName%></h2></div><%}%></div><%=btnhtml%></li></script><script type="text/template" id="Deposit"><li class="order-list-item deposit <%=OrderStatusName===\'已取消\' ? \'order-item-cancel\' : \'\'%>" data-oid="<%=OrderID%>" data-actions="<%=actions%>"><div class="order-hd<%=isAggregated===false ? \' order-hd-single\' : \'\'%>"><%if(isAggregated){%> <span class="order-type type-visa">存款证明</span> <%}%> <span class="order-status<%=OrderStatusCode==\'已成交\' ? \' order-status-succes\' : \'\'%>"><%=OrderStatusName%></span> <span class="order-price"><dfn>&yen;</dfn><%=DepositOrderItems[0].DepositedAmount%></span></div><div class="order-cont" data-url="<%=detail%>"><h2 class="ellips_line2"><%=OrderName%></h2><p class="order-info"><%=DepositTimeFrom[0]%>至<%=DepositTimeTo[0]%> 存款 ￥<%=OrderTotalPrice%></p></div><%=btnhtml%></li></script><script type="text/template" id="searchTpl"><section><div style="height:44px"><ul class="tab-model" style="position:fixed;left:0;z-index:999"><li class="tab-current">按类型/状态</li><li>按订单号</li></ul></div><div class="search"><%if (types.length > 0){%><h4 class="search-title">类型</h4><ul class="search-list type"><%for (var i = 0, len = types.length; i < len; i++){%><li <%=filter.type==types[i].code ? \' class="current" \' : \' \'%>data-code="<%=types[i].code%>"><%=types[i].name%></li><%}%></ul><%}%> <%if (statuses.length > 0){%><h4 class="search-title">状态</h4><ul class="search-list status"><%for (var i = 0, len = statuses.length; i < len; i++){%><li <%=filter.status==statuses[i].code ? \' class="current" \' : \' \'%>data-code="<%=statuses[i].code%>"><%=statuses[i].name%></li><%}%></ul><%}%><div class="btn-box"><button class="g_btn_s type">确定</button></div></div><div class="search" style="display:none"><ul class="form-list" style="margin-top:20px"><li><div><input type="tel" id="order_field" class="txt_order" maxlength="12" placeholder="请输入数字"></div></li></ul><div class="btn-box"><button class="g_btn_s order g_btns_disable">查询</button></div></div></section></script>'
}),define("basecard",["cUtilHybrid","cGuiderService","MyCtripModel","cUtilCryptBase64","myctripCommon","text!template","UILayerList","cHybridShell","UIMask"],function(e,t,i,a,r,n,s,o,l){var d=null,c=!1,p={0:66,2:66,3:76,4:90,5:104,6:118,7:132},u={code:"MoreBtn",content:"<i></i>",rankid:20,"class":"btn-more",isapp:0,style:0},f={Hotel:["Hotel","国内"],HotelDomestic:["Hotel","国内"],HotelMask:["Hotel","惠选"],HotelInternational:["Hotel","海外"],Train:["Train","国内"],TrainDomestic:["Train","国内"],TrainInternational:["Train","国际"],Flight:["Flight","国内"],FlightDomestic:["Flight","国内"],FlightInternational:["Flight","国际"]},h=function(e,t){if(t){var i=e&&f.hasOwnProperty(e)?f[e][1]:e;return i}var i=e&&f.hasOwnProperty(e)?f[e][0]:e;return i},m=function(e,t){var i=/^(\d{1,4})\-(\d{1,2})\-(\d{1,2})\s+(\d{1,2})\:(\d{1,2})\:(\d{1,2})$/,a="",r="",n="",s="",o="",l=function(e){return 10>e?"0"+e:e};if(e){var d=e.match(i);if(d)a=+d[1],r=l(+d[2]),n=l(+d[3]),s=l(+d[4]),o=l(+d[5]);else{var c=e.toDate(8);a=c.getFullYear(),r=l(c.getMonth()+1),n=l(c.getDate()),s=l(c.getHours()),o=l(c.getMinutes())}}switch(t){case"yyyy-mm-dd":return[a+"-"+r+"-"+n,s+":"+o];case"m月d日":return[r+"月"+n+"日",s+":"+o];default:return[r&&n?r+"-"+n:"",s&&o?s+":"+o:""]}},g=function(t){var i=!1,a=null,s=t.bizType,o=t.handlerConfig,l=t.events,f=t.timeConfig,h=!!e.isInApp,g=r.isunlogin(s),y="youth"==e.getAppSys(),v=r.isTieYou(),b=function(){if(!i){i=!0;var e='<script type="text\\/template" id="'+s+'">(((?!<\\/script>)[\\w\\W])*)<\\/script>',t=RegExp(e),r=t.exec(n);r&&(a=_.template(r[1])),T()}},w=function(e,t){e&&"function"==typeof l[e]&&l[e](t)},T=function(){"function"==typeof t.handler&&t.handler.call(t);var e=null,i="",a="",r=null,n=null,d=$.extend({},o,{"order-cont":{action:".detail"}});for(var c in d)if(d.hasOwnProperty(c)){e=d[c],e instanceof Array||(e=[e]);for(var p=0,u=e.length;u>p;p++)a=e[p].action,n=/\w*\.(\w+)/.exec(a),n&&n[1]&&(a=n[1],i="."+s.toLowerCase()+" ."+(e[p]["class"]||c)),r=l[a],r&&"function"==typeof r&&$(document).on("click",i,r)}},O=function(e){e&&("function"==typeof t.process&&t.process.call(t,e),e.isAggregated=d.isAggregated,C(e),I(e),"function"==typeof t.afterFilterData&&t.afterFilterData.call(t,e))},S=function(e){var t="";return O(e),t=a(e)},C=function(e){var t=e.field?f[e.field]:f,i=e.timeIndexes||[0,0],a=e[t.entity],r=t.collection,n=t.relate||!1,s=null,o="",l="",d=t.format,c="";if(n&&a&&a[0]){var p=a[0][r[0]].toDate(8),u=a[0][r[1]].toDate(8);if(p instanceof Date&&u instanceof Date)var h=p.getFullYear(),g=u.getFullYear(),y=(new Date).getFullYear();var v=!1;h&&g&&(v=h==g?g!=y:!0),d=v?1:d}for(var b=0,w=i.length;w>b;b++)s=r[b],s&&("string"==typeof s?o=l=s:(o=s.name||s.field,l=s.field||s.name,d=s.format||d),d=d?"yyyy-mm-dd":"",c=a&&a[i[b]]&&a[i[b]][l]||"",e[o]=m(c,d));t.booking&&e.BookingDate&&(e.BookingDate=m(e.BookingDate,d))},I=function(e){var t=[];e.detail="";for(var i=0,a=e.OrderActions,r=a.length;r>i;i++){var n=a[i].ActionCode,l=a[i].ActionURLH5;if(("Detail"===n||"ReadOrder"===n||"OrderDetailLink"===n||"ViewOrderDetail"===n||"ToDetail"===n||"OrderDetail"===n||"ViewOrderInfo"===n)&&(e.detail=l?l:""),o&&o.hasOwnProperty(n))for(var d=o[n]instanceof Array?o[n]:[o[n]],c=0;c<d.length;c++){var p=d[c],u=h?!!p.isShow[0]:!!p.isShow[1],f=g?!!p.isShow[2]:!0,m=y?!!p.isShow[3]:!0,b=v?!!p.isShow[4]:!0;u&&f&&m&&b&&t.push({code:n,content:p.content,rankid:p.rankid,style:p.style,action:p.action,actUrl:l,orderId:e.OrderID,bizType:s,"class":p["class"]||n})}}t.sort(function(e,t){return t.rankid-e.rankid}),e.actions=JSON.stringify(t).replace(/\"/g,"'"),e.btnhtml=D(t)},D=function(e){var t=$(document).width(),i=isShowSlideMenu?$("#ctripmenu-wrap").width()+10:0,a=t-i-40,r=[],n=[],s=[];if(!c&&e.length){for(var o=e.length,l=o-1,d=p,f=p[0],h=0;o>h;h++){var m=e[h].content.length;if(LeftLen=a,a-=d[m],0>a){l=LeftLen-f>=0?h-1:h-2;break}}if(n=e.slice(0,l+1),o>l+1){s=e.slice(l+1);for(var h=0;h<s.length;h++)r.push({key:s[h].code,val:s[h].content,action:s[h].action,actUrl:s[h].actUrl});if(r.length){var g=u;g.more=r,n.unshift(g),e=n}}}return k(e)},k=function(e){var t="";if(e.length){t+='<div class="order-ft">';for(var i=e.length-1;i>=0;i--){var a=e[i];if(a){var r=a.bizType+"_"+a["class"]+"_"+a.orderId,n="btn-more"!==a["class"]?' id="'+r+'"':"",s=' class="'+(a.style?"btn01 ":"btn02 ")+a["class"]+'"',o=a.code?' data-code="'+a.code+'"':"",l=a.action?' data-action="'+a.action+'"':"",d=a.more?" data-more='"+JSON.stringify(a.more)+"'":"";t+="<button"+n+s+o+l+d+">"+a.content+"</button>"}}t+="</div>"}return t};return{_init:b,_trigger:w,_layoutButton:D,render:S}},y=function(){var n=!1,p=!1,u={},f=function(){if(!n){n=!0;for(var e in u)u.hasOwnProperty(e)&&u[e]._init();$(document).on("click",".order-ft .btn-more",O)}},m=function(){p||(p=!0,$(document).on("click",".operation-list li",M).on("click",".orders-status-filter span",L),window.addEventListener("orientationchange",function(){P(),d&&d.bLoadDataError&&(d.hideWarning404(),d.showWarning404(function(){d.hideWarning404(),d.showView()}))}))},v=function(e){return e&&(e=h(e),u[e])?u[e]:void 0},b=function(){return d},w=function(e,t){d=e,"undefined"!=typeof t&&t===!0&&(c=!0)},T=function(e){if(d&&(e.viewType=d.viewType,e.BizType||(e.BizType=d.bizType),e&&e.BizType)){e.orderType=h(e.BizType,!0);var t=this.getCard(e.BizType);if(t)try{return t.render(e)}catch(i){return""}}},_=function(e){!(e&&e.bizType&&e.handlerConfig&&e.events);var t=u[e.bizType];return t||(t=g(e),u[e.bizType]=t),g},O=function(e){var t=d,i=$(e.currentTarget).data("more");if(i.length)if(isShowSlideMenu)N(i,e);else{for(var a in i)i[a].name=i[a].val,delete i[a].val;t.bottomPopup&&($("#"+t.bottomPopup.id).remove(),$("#"+t.bottomPopup.mask.id).remove()),t.bottomPopup=new s({datamodel:{list:i,cancelText:"取消操作"},onItemAction:function(t){var i=t.action,a=[],r=null,n=null,s=null;i&&(a=i.split("."),2===a.length&&(r=a[0],n=a[1],s=v(r),s&&($(e.currentTarget).data("code",t.key),s._trigger(n,e)))),this.hide()}}),t.bottomPopup.show()}},S=function(e,t){var i="",a=$(e.currentTarget);if(a.hasClass("order-cont"))i=a.data("url")||"";else if(a.data("url"))i=a.data("url");else{var t=t||a.data("code"),r=a.closest("li").data("actions"),n=null;if(r){r=JSON.parse(r.replace(/\'/g,'"'));for(var s=0,o=r.length;o>s;s++)if(n=r[s],n&&n.code==t){i=n.actUrl||"";break}}}return i},C=function(e,i,a,n){var s=d,l=null,a=a||"index.html#",c=/.*(\/webapp\/)(\w*)(\/)(.*)/;if(i=i||S(e),""!==i&&"undefined"!=typeof i){var l=c.exec(i.toLowerCase());r.apply({callback:function(){if(l){var e=l[1]+l[2]+l[3]+l[4];e+=e.indexOf("?")>-1?"&":"?",Lizard.jump(e+s.frompageurl)}},onlineCallback:function(){location.href=i},hybridCallback:function(){if(0===i.indexOf("ctrip://"))return o.Fn("open_url").run(i,1);if(l){var e=l[4];if(0===e.indexOf(a)&&(a="")||-1===e.indexOf(a)&&"#"===e[0]&&(a="index.html"),e=a+e,n)return e+=e.indexOf("?")>-1?"&":"?",t.cross({path:l[2],param:e+s.frompageurl});Lizard.jump(l[1]+l[2]+"/"+e,{targetModel:4})}else location.href=i}})}},I=function(e,t,a){var r=d,n=i.HideOrderModel.getInstance(),s=$(e.currentTarget).closest("li").data("oid"),o={BizType:t,OrderIDs:[s]};n.setParam({HideOrderInfos:o}),r.showConfirm({datamodel:{content:'<p style="padding-bottom:10px;font-weight:bold">删除订单后将无法还原</p>删除不等于取消，相关积分、返现等也可能受影响。确定完全删除此笔订单？',btns:[{name:"点错了",className:"cui-btns-miss"},{name:"删除",className:"cui-btns-del"}]},events:{"click .cui-btns-miss":"missAction","click .cui-btns-del":"delAction"},missAction:function(){this.hide()},delAction:function(){this.hide(),r.showLoading(),n.excute(function(e){r.hideLoading(),a&&"function"==typeof a&&a(e)||r.showToast(e&&e.Result&&0==e.Result.ResultCode?{datamodel:{content:"删除成功"},hideAction:function(){r.onShow()}}:"删除失败，请稍后再试")},function(){r.hideLoading(),r.showToast("删除失败，请稍后再试")},!0,r,function(){r.hideLoading(),r.showToast("删除失败，请稍后再试")})}})},D=function(e,t,i){var a=d;a.showConfirm({datamodel:{content:"确定取消订单吗？",btns:[{name:"点错了",className:"cui-btns-miss"},{name:"取消订单",className:"cui-btns-sure"}]},events:{"click .cui-btns-sure":"sureAction","click .cui-btns-miss":"missAction"},sureAction:function(){this.hide(),a.showLoading(),t.excute(function(e){a.hideLoading(),"function"==typeof i&&i(e)},function(){a.hideLoading(),a.showToast("取消失败，请稍后再试")},!0,a,function(){a.hideLoading(),a.showToast("取消失败，请稍后再试")})},missAction:function(){this.hide()}})},k=function(r,n,s){var o=d,l=$(r.currentTarget).closest("li").data("oid"),p=i.OrderPaymentModel.getInstance(),u=o.frompageurl,f=/(.*\/webapp\/myctrip\/)(.*)/.exec(decodeURIComponent(o.frompageurl));return f&&(u=f[1]+"index.html#"+f[2]),c?y.jump(r):(p.setParam({PaymentOrderInfos:[{BizType:n,OrderIDs:[l]}],From:location.href,Platform:e.isInApp?"Hybrid":"H5"}),o.showLoading(),void p.excute(function(i){if(o.hideLoading(),i&&i.Result&&0==i.Result.ResultCode)if(i.PaymentInfos&&i.PaymentInfos[0]&&i.PaymentInfos[0].PaymentPagePath){var r=i.PaymentInfos[0];if(i.paymentUrl=r.PaymentPagePath,"Visa"==n&&!r.Token)return t.jump({url:i.paymentUrl,targetModel:"h5",title:""});if(r.Oid){var l=i.paymentUrl.indexOf("?")>-1?"&":"?";i.paymentUrl=i.paymentUrl+l+"oid="+r.Oid}if(r.BusType){var l=i.paymentUrl.indexOf("?")>-1?"&":"?";i.paymentUrl=i.paymentUrl+l+"bustype="+r.BusType}if(r.Token){var d=encodeURIComponent(a.Base64.encode(r.Token)),l=i.paymentUrl.indexOf("?")>-1?"&":"?";i.paymentUrl=i.paymentUrl+l+"token="+d}if(r.Extend){var c=encodeURIComponent(a.Base64.encode(r.Extend)),l=i.paymentUrl.indexOf("?")>-1?"&":"?";i.paymentUrl=i.paymentUrl+l+"extend="+c}if(s&&"function"==typeof s&&s(i))return;if(e.isInApp){var p=/(.*)(\/)(.*)(\/)(index.html.*)/,u=p.exec(i.paymentUrl),f=t.cross,h=["TopShop","QiChe","GlobalBuy","Activity","Piao","Tuan","VacationInsurance","Mall","Train","Visa","Lipin"];(h.indexOf(n)>-1||"Vacation"===n&&r.Token)&&(f=t.pay.callPay),f({path:u[3],param:u[5]+"&"+o.frompageurl})}else o.jump(i.paymentUrl+"&"+o.frompageurl)}else o.showToast("加载失败，请稍后再试");else o.showMessage(i.Result.ResultMsg||"加载失败，请稍后再试")},function(e){o.hideLoading(),o.showMessage(e.Result.ResultMsg||"加载失败，请稍后再试")},!0,o,function(e){o.hideLoading(),o.showMessage(e.Result.ResultMsg||"加载失败，请稍后再试")}))},x=function(e){for(var i=e&&e.title||"推荐携程旅行",a=e&&e.text||"",r=e&&e.imageUrl||"",n=e&&e.linkUrl||"",s=["客户端下载地址：http://m.ctrip.com/m/c925","快来@携程旅行，开启自己的旅程吧！","客服电话：400-821-6666，"],o=0,l="";(a+l+s[o]).length<141&&3>o;)l=s[o]+l,o++;a+=l,t.apply({hybridCallback:function(){CtripShare.wrap_call_default_share(r,i,a,n)},callback:function(){}})},A=function(){return"allorders"===d.viewType&&d.bOffline&&!d.bLogin?!0:!1},P=function(e){if(isShowSlideMenu){e||(e=d.$el.find(".order-list-item"));for(var t=0,i=e.length;i>t;t++){var a=e.eq(t),r=a&&a.data("actions"),n="",s=null;r&&r.length>=5&&(s=v(r[0].bizType),s&&(n=s._layoutButton(r),n&&(a.find(".order-ft").remove(),a.append(n))))}}},N=function(e,t){if(e&&e.length){for(var i='<div class="pop-myctrip"><ul class="operation-list">',a=null,r=null,n=$(t.currentTarget).offset(),s=n.left,o=n.top,d=0,c=e.length;c>d;d++)a=e[d],i+='<li data-action="'+a.action+'" data-url="'+a.actUrl+'">'+a.val+"</li>";i+="</ul></div>",r=$(i),s-=267,o+=47,r.css({position:"absolute","z-index":9999,width:"320px",left:s+"px",top:o+"px"}).appendTo($(document.body));var p=new l;p.$el.addClass("myctrip-mask"),p.show(),$("#"+p.id).click(function(){$(this).remove(),r.remove()})}},M=function(e){var t=$(e.currentTarget).data("action"),i=[],a=null,r=null,n=null;t&&(i=t.split("."),2===i.length&&(a=i[0],r=i[1],n=v(a),n&&(n._trigger(r,e),$(e.currentTarget).parents(".pop-myctrip").remove(),$("body").children(".myctrip-mask").remove())))},L=function(e){var t=$(e.currentTarget);t.hasClass("current")||d.jump(t.data("url"))};return{init:f,initForPad:m,getCard:v,getView:b,setView:w,render:T,getInstance:_,getJumpUrl:S,jump:C,cancel:D,del:I,pay:k,share:x,checkOfflineJump:A,relayoutButton:P}}();return y}),define("flightcard",["basecard","MyCtripModel","MyCtripStore","cGuiderService","cUtilHybrid"],function(e,t,i,a,r){return e.getInstance({bizType:"Flight",timeConfig:{format:0,entity:"FlightOrderItems",collection:[{field:"DepartureDateTimeStr",name:"DepartureDate",format:""},{field:"ArrivalDateTimeStr",name:"ArrivalDate",format:""},{field:"DepartureDateTimeStr",name:"BackDepartureDate",format:""},{field:"ArrivalDateTimeStr",name:"BackArrivalDate",format:""}],booking:0},handlerConfig:{CheckIn:{content:"值机",rankid:6,isShow:[1,0,0,1,0],style:1,action:"Flight.checkin"},HideOrder:{content:"删除",rankid:1,isShow:[1,1,0,1,0],style:0,action:"Flight.del"},Cancel:{content:"取消",rankid:2,isShow:[1,1,0,1,0],style:0,action:"Flight.cancel"},Refund:{content:"退票",rankid:4,isShow:[1,0,0,1,0],style:0,action:"Flight.refund"},Rebook:{content:"改签",rankid:5,isShow:[1,0,0,1,0],style:0,action:"Flight.rebook"},ReBookPost:{content:"修改配送",rankid:3,isShow:[1,0,0,1,0],style:0,action:"Flight.rebookpost"},DelayedToImmediately:{content:"付款出票",rankid:8,isShow:[1,0,0,1,0],style:0,action:"Flight.delayedToImmediately"},EditPayType:{content:"去支付",rankid:9,isShow:[1,0,0,1,0],style:1,action:"Flight.detail"}},process:function(e){var t=this,i=e[this.timeConfig.entity];e.depFlightInfo=i instanceof Array&&i.length?i[0]:{};var a=i[0].TripType;if(e.isSingleTrip="单程"===a,e.isConnecting="联程"===a,e.isTypeReturn="往返"===a,e.isFlightAndTrain=e.isSingleTrip&&e.TrainOrderItems&&e.TrainOrderItems.length>0||!1,e.timeIndexes=[0,0],e.isSingleTrip)for(var r=0,n=i.length;n>r&&1==i[r].SegmentNo;r++)e.timeIndexes[1]=r;else if(e.isConnecting)e.timeIndexes[1]=i.length-1;else if(e.isTypeReturn){for(var s=!1,r=0,n=i.length;n>r;r++)1==i[r].SegmentNo?e.timeIndexes[1]=r:2==i[r].SegmentNo&&(s||(s=!0,e.timeIndexes[2]=r),e.timeIndexes[3]=r);e.isUnAbandon=s}e.arrFlightInfo=e.isTypeReturn&&s?i[e.timeIndexes[2]]:i[e.timeIndexes[1]],e.depFlightInfo.DepartureDisplayName=this._getSiteName(e.depFlightInfo,"DepartureCity","DepartureAirport"),e.depFlightInfo.ArrivalDisplayName=this._getSiteName(e.depFlightInfo,"ArrivalCity","ArrivalAirport"),e.arrFlightInfo.DepartureDisplayName=this._getSiteName(e.arrFlightInfo,"DepartureCity","DepartureAirport"),e.arrFlightInfo.ArrivalDisplayName=this._getSiteName(e.arrFlightInfo,"ArrivalCity","ArrivalAirport"),e.isFlightAndTrain&&(e.FlightsAndTrains=e.FlightOrderItems.concat(e.TrainOrderItems),e.FlightsAndTrains.sort(this._sortDate),e.flightAndTrainHtml="",e.FlightsAndTrains.forEach(function(i){e.flightAndTrainHtml+=i.hasOwnProperty("TrainNumber")?'<p class="order-info">铁: '+t._getRangeDate(i.DepartureDateStr,i.ArrivalDateStr)+'<span class="item">'+i.TrainNumber+"</span></p>":'<p class="order-info">空: '+t._getRangeDate(i.DepartureDateTimeStr,i.ArrivalDateTimeStr)+'<span class="item">'+i.FlightNo+"</span></p>"}))},events:{detail:function(t){if(!e.checkOfflineJump()){var r=e.getView(),n=$(t.currentTarget).closest("li"),s=n.data("oid"),o=n.data("type"),l="";if(r.frompageurl?0==r.frompageurl.indexOf("from=")&&(l=r.frompageurl.slice(5),l=decodeURIComponent(decodeURIComponent(l))):l="/webapp/myctrip/orders/"+r.viewType,data={Id:s,url:l},"FlightDomestic"==o){var d=i.FlightOrderParamStore.getInstance();d.set(data),a.jump({targetModel:"app",url:"/webapp/flight/index.html#flightorderdetail",module:"InlandFlightOrder",param:{orderId:s}})}else{var c=i.FltintlOrderId.getInstance();c.set(data),a.jump({targetModel:"app",url:"/webapp/fltintl/index.html#fltintlorderdetail",module:"InternationalFlightOrder",param:{orderId:s}})}}},checkin:function(t){var r=e.getView(),n=$(t.currentTarget).closest("li"),s=n.data("oid"),o=n.data("type"),l={Id:s,url:"/webapp/myctrip/orders/"+r.viewType};if("home"==r.viewType&&(l.url=decodeURIComponent(r.frompageurl.slice(5))),"FlightDomestic"==o){var d=i.FlightOrderParamStore.getInstance();d.set(l),a.jump({targetModel:"app",url:"/webapp/flight/index.html#flightorderdetail",module:"flight_checkin_list",param:{orderId:s}})}else{var c=i.FltintlOrderId.getInstance();c.set(l),a.jump({targetModel:"app",url:"/webapp/fltintl/index.html#fltintlorderdetail",module:"flight_checkin_list",param:{}})}},del:function(t){e.del(t,"FlightDomestic")},cancel:function(i){var a=e.getView(),r=t.FlightCancelModel.getInstance(),n=$(i.currentTarget).closest("li");r.setParam("oid",n.data("oid")),e.cancel(i,r,function(e){a.showToast(e&&0==e.res?{datamodel:{content:"取消成功"},hideAction:function(){a.onShow()}}:e&&e.msg||"取消失败，请稍后再试")})},refund:function(t){var i=$(t.currentTarget).closest("li"),n=i.data("oid"),s=i.data("type"),o=e.getView();if("FlightDomestic"==s)a.jump({targetModel:"app",url:"/webapp/flight/index.html#flightorderdetail",module:"flight_inland_refund",param:{c1:n}});else{var l="",d="/webapp/flighthybrid/fltintlRefund.html?oid="+n+"&source=app&";d+=decodeURIComponent(o.frompageurl),l=0==r.isPreProduction()?"http://w-flight-m.fat19.qa.nt.ctripcorp.com":"http://m.ctrip.com";var c=l+d+"&type=2";a.jump({targetModel:"h5",url:c})}},rebook:function(e){var t=$(e.currentTarget).closest("li"),i=t.data("oid"),r=t.data("type");a.jump("FlightDomestic"==r?{targetModel:"app",url:"/webapp/flight/index.html#flightorderdetail",module:"flight_inland_change",param:{c1:i}}:{targetModel:"app",url:"/webapp/fltintl/index.html#fltintlorderdetail",module:"InternationalFlightOrder",param:{orderId:i,orderType:0}})},rebookpost:function(e){var t=$(e.currentTarget).closest("li"),i=t.data("oid"),r=t.data("type");a.jump("FlightDomestic"==r?{targetModel:"app",url:"/webapp/flight/index.html#flightorderdetail",module:"flight_inland_orderedit",param:{c1:i}}:{targetModel:"app",url:"/webapp/fltintl/index.html#fltintlorderdetail",module:"flight_int_orderedit",param:{c1:i}})},delayedToImmediately:function(e){{var t=$(e.currentTarget).closest("li"),i=t.data("oid");t.data("type")}a.jump({targetModel:"app",url:"/webapp/fltintl/index.html#fltintlorderdetail",module:"flight_int_temp",param:{c1:i}})},editPayType:function(){}},_sortDate:function(e,t){var i=/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/,a=null,r=null;if(first=e.DepartureDateTimeStr||e.DepartureDateStr,second=t.DepartureDateTimeStr||t.DepartureDateStr,first===second)return 0;if(a=i.exec(first),r=i.exec(second),a&&r)for(var n=1,s=a.length;s>n;n++){if(a[n]>r[n])return 1;if(a[n]<r[n])return-1}return 0},_getSiteName:function(e,t,i){return e[i]&&0===e[i].indexOf(e[t])?e[i]:e[t]+(e[i]||"")},_getRangeDate:function(e,t){var i=/(\d{4})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})/;return result1=i.exec(e),result2=i.exec(t),result="",result1&&result2?(result='<span class="date">'+result1[2]+"-"+result1[3]+'</span>&nbsp;<span class="hour">'+result1[4]+":"+result1[5]+"</span>&nbsp;至&nbsp;",result+=result1[2]===result2[2]?'<span class="hour">'+result2[4]+":"+result2[5]+"</span>":'<span class="hour">'+result2[2]+"-"+result2[3]+'</span>&nbsp;<span class="hour">'+result2[4]+":"+result2[5]+"</span>"):result='<span class="date">'+e+'</span>&nbsp;至&nbsp;<span class="date">'+t+"</span>",result}})}),define("topshopcard",["basecard","cUtilCommon","cUtilHybrid","MyCtripModel","CommonStore","cGuiderService"],function(e,t,i,a,r,n){return e.getInstance({bizType:"TopShop",timeConfig:{format:0,entity:"TopShopOrderItems",collection:["BeginValidTime","EndValidTime"],booking:0,relate:!0},handlerConfig:{ContinuePay:{content:"去付款",rankid:2,isShow:[1,1,0,1,0],style:1,action:"TopShopEvent.pay"},OrderCancel:{content:"取消",rankid:1,isShow:[1,1,0,1,0],style:0,action:"TopShopEvent.cancel"}},process:function(e){var t=e[this.timeConfig.entity];e.orderInfo=t instanceof Array&&t.length?t[0]:{}},events:{detail:function(t){e.jump(t)},pay:function(i){var a=e.getView();e.pay(i,"TopShop",function(e){if(0==e.PaymentInfos[0].PaymentInfoCode)if(t.isInApp){var i=/(.*)(\/)(.*)(\/)(index.html.*)/,r=i.exec(e.paymentUrl);n.pay.callPay({path:r[3],param:r[5]+"&"+a.frompageurl})}else a.jump(e.paymentUrl+"&"+a.frompageurl);else a.confirm.setViewData({title:"",message:"此订单2小时内未完成支付已被取消，请重新下单",buttons:[{text:"知道了",click:function(){this.hide(),a.onShow()}}]}),a.confirm.show();return!0})},cancel:function(n){var s=e.getView(),o=a.TopShopCancelModel.getInstance(),l=$(n.currentTarget).closest("li").data("oid"),d=r.UserStore.getInstance(),c=d?d.getUser():null,p={Channel:"0000",ExternalChannel:"",Auth:c?c.Auth:"",Culture:"zh-cn",SessionId:t.getGuid(),ClientIP:""};o.setParam("Body",{OrderId:l}),o.setParam("RequestHead",p),(0==i.isPreProduction()||window.location.host.match(/^m\.fat\d*\.qa\.nt\.ctripcorp\.com|^210\.13\.100\.191/i))&&o.url.indexOf("subEnv=fat1")<0&&(o.url+="?subEnv=fat1"),e.cancel(n,o,function(e){s.showToast(e&&e.ResponseStatus&&"Success"==e.ResponseStatus.Ack?{datamodel:{content:"订单已取消"},hideAction:function(){s.onShow()}}:"取消失败")})}}})}),define("hotelcard",["basecard","MyCtripModel","cGuiderService","myctripCommon"],function(e,t,i,a){return e.getInstance({bizType:"Hotel",timeConfig:{format:0,entity:"HotelOrderItems",collection:["CheckInDate","CheckOutDate"],booking:0,relate:!0},handlerConfig:{Commit:{content:"继续预订",rankid:8,isShow:[1,0,0,1,0],style:1,action:"Hotel.commit"},Modify:{content:"修改",rankid:7,isShow:[1,0,0,1,0],style:0,action:"Hotel.modify"},Extend:{content:"办理延住",rankid:6,isShow:[1,0,0,1,0],style:0,action:"Hotel.extend"},MakeUrgent:{content:"加急处理",rankid:5,isShow:[1,1,0,1,0],style:0,action:"Hotel.makeUrgent"},Share:{content:"分享",rankid:4,isShow:[1,0,0,1,0],style:0,action:"Hotel.share"},AddComment:{content:"点评",rankid:3,isShow:[1,1,0,1,0],style:0,action:"Hotel.addComment"},Cancel:{content:"取消",rankid:2,isShow:[1,1,0,1,0],style:0,action:"Hotel.cancel"},HideOrder:{content:"删除",rankid:1,isShow:[1,1,0,1,0],style:0,action:"Hotel.hideOrder"}},process:function(e){e&&e.OrderActions&&!e.isOfflineOrder&&e.OrderActions.push({ActionCode:"Share",ActionName:"分享"})},afterFilterData:function(e){if(e&&e.HotelOrderItems&&e.HotelOrderItems[0]&&e.CheckInDate&&e.CheckOutDate){var t=e.Currency;("CNY"==t||"RMB"==t)&&(t="¥"),e.shareItem=[e.OrderName,t+e.OrderTotalPrice,e.HotelOrderItems[0].RoomAmount,e.HotelOrderItems[0].RoomType,e.HotelOrderItems[0].HotelAddress,e.CheckInDate[0],e.CheckOutDate[0]].join("|")}},events:{addComment:function(t){var a=e.getView(),r=$(t.currentTarget).closest("li"),n=r.data("name"),s=r.data("oid"),o=r.data("hotelid"),l={value:{oid:s,hotelId:o,hotelName:n,url:"/webapp/myctrip/orders/"+a.viewType}};("searchresult"==a.viewType||"home"==a.viewType)&&(l.value.url=decodeURIComponent(a.frompageurl.slice(5))),localStorage.setItem("CUSTOMER_HOTELORDER_ID",JSON.stringify(l)),i.jump({targetModel:"app",url:"/webapp/hotel/ordercomment",module:"HotelCommentSubmit",param:{hotelId:o,orderId:s,hotelName:n}})},extend:function(e){var t=$(e.currentTarget).closest("li").data("oid");i.jump({targetModel:"app",module:"hotel_inland_delayorder",param:{c1:t}})},cancel:function(i){var a=e.getView(),r=t.CustomerHotelOrderCancelModel.getInstance(),n=$(i.currentTarget).closest("li");r.setParam("oid",n.data("oid")),e.cancel(i,r,function(e){a.showToast(e.res?{datamodel:{content:"订单取消成功"},hideAction:function(){a.onShow()}}:"订单取消失败")})},modify:function(e){var t=$(e.currentTarget).closest("li").data("oid");i.jump({targetModel:"app",module:"hotel_inland_modifyorder",param:{c1:t,c2:"0"}})},makeUrgent:function(i){var a=e.getView(),r=t.CustomerHotelOrderUrgentModel.getInstance(),n=$(i.currentTarget).closest("li").data("oid");a.showLoading(),a.showMessage({datamodel:{content:"您的订单已加急,请耐心等待"},okAction:function(){this.hide(),a.onShow()}}),r.setParam("OrderID",n),r.excute(function(e){"0"==e.Result.ResultCode?(a.hideLoading(),a.confirm.show()):(a.hideLoading(),a.showToast("订单加急失败，请您稍后再试")),a.hideLoading()},function(){a.hideLoading(),a.showToast("加载失败，请稍后再试")},!0,a,function(){a.hideLoading(),a.showToast("操作失败，请稍后再试")})},commit:function(e){var t=$(e.currentTarget).closest("li").data("oid");i.jump({targetModel:"app",module:"hotel_inland_modifyorder",param:{c1:t,c2:"1"}})},detail:function(t){if(!e.checkOfflineJump()){var r=a.checkLogin();if(3!==r&&0!==r){var n=e.getView(),s=$(t.currentTarget).closest("li").data("oid"),o=""==n.token||void 0==n.token?"":"&token="+n.token,l="&allianceid=23823&sid=458871",d="/webapp/hotel/orderdetail?orderid="+s+"&"+n.frompageurl+o;a.isTieYou()&&(d="/webapp/hotel/orderdetail?orderid="+s+l+"&"+n.frompageurl+o),i.jump({targetModel:"app",url:d,module:"NormalHotelOrder",param:{orderId:s}})}}},hideOrder:function(t){e.del(t,"HotelDomestic")},share:function(t){var i=$(t.currentTarget).closest("li").data("share").split("|")||"";if(i instanceof Array){var a="携程旅行客户端帮我预订了"+i[0]+"总价为"+i[1]+"元的"+i[2]+"间"+i[3]+"。地址："+i[4]+"，日期："+i[5]+"至"+i[6]+"。";e.share({title:"推荐携程酒店",text:a})}}}})}),define("vacationcard",["basecard","cUtilCommon","cGuiderService"],function(e,t,i){return e.getInstance({bizType:"Vacation",timeConfig:{format:0,entity:"VacationOrderItems",collection:["DepartureDate"],booking:0},handlerConfig:{ToPay:{content:"去付款",rankid:13,isShow:[1,1,0,1,0],style:1,action:"Vacation.pay"},Repeat:{content:"继续预订",rankid:12,isShow:[1,1,0,1,0],style:1,action:"Vacation.guide"},ModifyOrder:{content:"修改",rankid:11,isShow:[1,1,0,1,0],style:0,action:"Vacation.guide"},ModifyClient:{content:"修改旅客",rankid:10,isShow:[1,1,0,1,0],style:0,action:"Vacation.guide"},ModifyInvoice:{content:"修改发票",rankid:9,isShow:[1,1,0,1,0],style:0,action:"Vacation.guide"},Modify:{content:"修改联系人",rankid:8,isShow:[1,1,0,1,0],style:0,action:"Vacation.guide"},TourAssistant:{content:"团队助手",rankid:7,isShow:[1,1,0,1,0],style:0,action:"Vacation.tourAssistant"},Comment:{content:"点评",rankid:6,isShow:[1,1,0,1,0],style:0,action:"Vacation.guide"},Share:{content:"分享",rankid:6,isShow:[1,0,0,1,0],style:0,action:"Vacation.share"},ViewPKG:{content:"查看行程",rankid:4,isShow:[1,1,0,1,0],style:0,action:"Vacation.directToH5"},ViewConfirmation:{content:"查看确认单",rankid:3,isShow:[1,1,0,1,0],style:0,action:"Vacation.guide"},ViewTourNotice:{content:"出团说明",rankid:2,isShow:[1,1,0,1,0],style:0,action:"Vacation.directToH5"},Cancel:{content:"取消",rankid:1,isShow:[1,1,0,1,0],style:0,action:"Vacation.guide"},HideOrder:{content:"删除",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Vacation.del"},AddComment:{content:"追加点评",rankid:5,isShow:[1,1,0,1,0],style:0,action:"Vacation.guide"}},process:function(e){var t=["已付款","已出票","已成交"],i=e.OrderStatusName||"";e&&e.OrderActions&&!e.isOfflineOrder&&$.inArray(i,t)>-1&&e.OrderActions.push({ActionCode:"Share",ActionName:"分享"})},afterFilterData:function(e){if(e.shareItem="",e&&e.VacationOrderItems&&e.VacationOrderItems[0]&&e.DepartureDate&&e.Passagers){var t=e.Passagers.length,i="";t&&(i=(e.Passagers[0]||"")+(e.Passagers[0]&&e.Passagers[1]?"、":"")+(e.Passagers[1]||"")+(t>2?"等":"")),e.shareItem=(e.VacationOrderItems[0].ProductName||"")+"|"+(e.OrderTotalPrice||"")+"|"+e.DepartureDate[0]+"日|"+(i?"，出行人是"+i:"")}},events:{directToH5:function(t){{var a=e.getJumpUrl(t);e.getView()}i.jump({url:a,targetModel:"h5",title:""})},guide:function(t){e.jump(t)},detail:function(t){e.jump(t)},del:function(t){e.del(t,"Vacation")},share:function(t){var i=$(t.currentTarget).closest("li").data("share").split("|")||"";if(i instanceof Array){var a=i[0].length>15?i[0].substring(0,15)+"...":i[0],r="携程旅行客户端帮我预订了"+i[0]+"总价为"+i[1]+"元，"+i[2]+"出发"+i[3]+"。";e.share({title:a,text:r})}},pay:function(i){e.pay(i,"Vacation",function(e){if(e.paymentUrl&&t.isInApp){var i=/.*(\/webapp\/)(\w*)(\/)(.*)/,a=i.exec(e.paymentUrl);a&&a[4]&&a[4].indexOf("index.html#")<0&&(e.paymentUrl=a[1]+a[2]+a[3]+"index.html#"+a[4])}})},tourAssistant:function(t){var i=e.getView(),a=e.getJumpUrl(t);a+=a.indexOf("?")>-1?"&":"?",i.jump(a+i.frompageurl)}}})}),define("carcard",["basecard"],function(e){return e.getInstance({bizType:"Car",timeConfig:{format:0,entity:"CarOrderItems",collection:["UsageDate"],booking:0},handlerConfig:{Remove:{content:"删除",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Car.del"},Cancel:{content:"取消",rankid:1,isShow:[1,1,0,1,0],style:0,action:"Car.guide"},Comment:{content:"点评",rankid:2,isShow:[1,1,0,1,0],style:0,action:"Car.guide"},SearchComment:{content:"查看点评",rankid:3,isShow:[1,1,0,1,0],style:0,action:"Car.guide"},ContinueBook:{content:"继续预订",rankid:4,isShow:[1,1,0,1,0],style:0,action:"Car.guide"}},events:{detail:function(t){var i=e.getJumpUrl(t);i=-1===i.indexOf("/webapp/")&&0!=deviceEnv?"/webapp"+i:i,e.jump(t,i)},guide:function(t){var i=e.getJumpUrl(t);i=-1===i.indexOf("/webapp/")&&0!=deviceEnv?"/webapp"+i:i,e.jump(t,i)},del:function(t){e.del(t,"Car")}}})}),define("piaocard",["basecard","MyCtripModel"],function(e,t){return e.getInstance({bizType:"Piao",timeConfig:{format:0,entity:"PiaoOrderItems",collection:["DepartureDate"],booking:0},handlerConfig:{Cancel:{content:"取消",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Piao.cancel"},Unsubscribe:{content:"取消",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Piao.unsubscribe"},Comment:{content:"点评","class":"comment",rankid:1,isShow:[1,1,0,1,0],style:0,action:"Piao.comment"},ReSendSMS:{content:"重发短信","class":"btn-message",rankid:2,isShow:[1,1,0,1,0],style:0,action:"Piao.message"},ContinuePay:{content:"去支付",rankid:3,isShow:[1,1,0,1,0],style:1,action:"Piao.pay"}},process:function(e){for(var t=e.OrderActions,i="",a=0,r=t.length;r>a;a++){var n=t[a];if("Cancel"===n.ActionCode){i=n.ActionURLH5;break}}e.ActionURLH5=i},events:{detail:function(t){if(!e.checkOfflineJump()){var i=$(t.currentTarget).closest("li").data("oid"),a="/webapp/ticket/orderdetail?orderid="+i;e.jump(t,a,"index.html#/")}},cancel:function(i){var a=e.getView(),r=t.TicketCancelOrderModel.getInstance(),n=$(i.currentTarget).closest("li"),s=n.data("url");s?e.jump(i,s,"index.html#/"):(r.setParam({oid:n.data("oid"),optype:1}),e.cancel(i,r,function(e){a.showToast(e&&"Success"===e.ResponseStatus.Ack?{datamodel:{content:"取消成功"},hideAction:function(){n.find(".order-ft").hide(),n.find(".order-status").text("取消中")}}:"取消失败，请稍后再试")}))},unsubscribe:function(i){var a=e.getView(),r=t.TicketCancelOrderModel.getInstance(),n=$(i.currentTarget).closest("li"),s=n.data("url");s?e.jump(i,s,"index.html#/"):(r.setParam({oid:n.data("oid"),optype:2}),e.cancel(i,r,function(e){a.showToast(e&&"Success"===e.ResponseStatus.Ack?{datamodel:{content:"退订成功"},hideAction:function(){n.find(".order-ft").hide(),n.find(".order-status").text("退订中")}}:"取消失败，请稍后再试")}))},pay:function(t){e.pay(t,"Piao")},message:function(i){var a=e.getView(),r=$(i.currentTarget);if(!r.hasClass("btn02_disabled")){var n=r.closest("li").data("oid"),s=r.closest("li").data("mobile")||"",o="入园凭证短信将发送至"+s;a.showConfirm({datamodel:{content:o,btns:[{name:"点错了",className:"cui-btns-cancel"},{name:"确定发送",className:"cui-btns-ok"}]},cancelAction:function(){this.hide()},okAction:function(){this.hide();var e=t.TicketSendMessageModel.getInstance();a.showLoading(),e.setParam("oid",n),e.setParam("mbi",s),e.excute(function(e){if(a.hideLoading(),e&&"Success"===e.ResponseStatus.Ack){var t=e.data.msg;a.showToast({datamodel:{content:t},hideAction:function(){r.removeClass("btn02").addClass("btn02_disabled").html("已发送")}})}else a.showToast("发送失败")},function(){a.hideLoading(),a.showToast("发送失败，请稍后再试")},!0,a,function(){a.hideLoading(),a.showToast("发送失败，请稍后再试")})}})}},comment:function(t){e.jump(t,"","index.html#/")}}})}),define("activitycard",["basecard","MyCtripModel"],function(e,t){return e.getInstance({bizType:"Activity",timeConfig:{format:0,entity:"ActivityOrderItems",collection:["UsageDate","ExpiredDate"],booking:0},handlerConfig:{Cancel:{content:"取消",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Activity.cancel"},Unsubscribe:{content:"取消",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Activity.unsubscribe"},Comment:{content:"点评",rankid:2,isShow:[1,1,0,1,0],style:0,action:"Activity.addComment"},ReSendSMS:{content:"重发短信",rankid:1,isShow:[1,1,0,1,0],style:0,action:"Activity.message"},ContinuePay:{content:"去付款",rankid:3,isShow:[1,1,0,1,0],style:1,action:"Activity.pay"}},process:function(e){var t=e.ActivityOrderItems[0];if(e.isWifi=!1,t&&t.ExpiredDate&&t.UsageDate)if("-"==t.ExpiredDate[t.ExpiredDate.indexOf("(")+1])e.isWifi=!1;else{var i=t.ExpiredDate.replace(/\D/gim,"").substring(0,13),a=t.UsageDate.replace(/\D/gim,"").substring(0,13);e.isWifi=+i-+a>0}},events:{detail:function(t){e.jump(t,"","index.html#/")},addComment:function(t){e.jump(t,"","index.html#/")},cancel:function(i){var a=e.getView(),r=t.ActivityCancelOrderModel.getInstance(),n=$(i.currentTarget).closest("li");
r.setParam({oid:n.data("oid"),optype:1}),e.cancel(i,r,function(e){a.showToast(e.data&&e.data.rslt?{datamodel:{content:"取消成功"},hideAction:function(){n.find(".order-ft").hide(),n.find(".order-status").text("取消中")}}:"取消失败，请稍后再试")})},unsubscribe:function(i){var a=e.getView(),r=t.ActivityCancelOrderModel.getInstance(),n=$(i.currentTarget).closest("li");r.setParam({oid:n.data("oid"),optype:2}),e.cancel(i,r,function(e){a.showToast(e.data&&e.data.rslt?{datamodel:{content:"退订成功"},hideAction:function(){n.find(".order-ft").hide(),n.find(".order-status").text("退订中")}}:"取消失败，请稍后再试")})},pay:function(t){e.pay(t,"Activity")},message:function(i){var a=e.getView(),r=$(i.currentTarget);if(!r.hasClass("btn02_disabled")){var n=r.closest("li").data("oid"),s=r.closest("li").data("mobile")||"",o="入园凭证短信将发送至"+s;a.showConfirm({datamodel:{content:o,btns:[{name:"点错了",className:"cui-btns-cancel"},{name:"确定发送",className:"cui-btns-ok"}]},cancelAction:function(){this.hide()},okAction:function(){this.hide();var e=t.ActivitySendMessageModel.getInstance();a.showLoading(),e.setParam("oid",n),e.setParam("mbi",s),e.excute(function(e){a.hideLoading(),a.showToast(e&&e.data&&e.data.rslt?{datamodel:{content:"发送成功！"},hideAction:function(){r.removeClass("btn02").addClass("btn02_disabled").html("已发送")}}:"发送失败，请稍后再试")},function(){a.hideLoading(),a.showToast("发送失败，请稍后再试")},!0,a,function(){a.hideLoading(),a.showToast("发送失败，请稍后再试")})}})}}}})}),define("taxicard",["basecard"],function(e){return e.getInstance({bizType:"Taxi",timeConfig:{format:0,entity:"TaxiOrderItems",collection:["UsageDate"],booking:0},handlerConfig:{Cancel:{content:"取消",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Taxi.cancel"}},events:{detail:function(t){if(!e.checkOfflineJump()){var i=$(t.currentTarget).data("url"),a=$(t.currentTarget).closest("li").data("oid");i||(i="/car/#taxiorderdetail!orderlist?id="+a),i=-1===i.indexOf("/webapp/")?"/webapp"+i:i,e.jump(t,i)}},cancel:function(t){var i=e.getJumpUrl(t);i=-1===i.indexOf("/webapp/")?"/webapp"+i:i,e.jump(t,i)}}})}),define("tuancard",["basecard","CommonStore","MyCtripModel","cUtilCryptBase64","myctripCommon"],function(e,t,i,a,r){return e.getInstance({bizType:"Tuan",timeConfig:{case1:{format:1,entity:"TuanOrderItems",collection:["ExpireDate"],booking:0},case2:{format:1,entity:"TuanOrderItems",collection:["TakeEffectDate"],booking:0}},handlerConfig:{Delorder:{content:"删除",rankid:1,isShow:[1,1,1,1,0],style:0,action:"Tuan.del"},Closeorder:{content:"取消",rankid:2,isShow:[1,1,1,1,0],style:0,action:"Tuan.cancel"},PayBack:{content:"申请退款",rankid:3,isShow:[1,1,1,1,0],style:0,action:"Tuan.payBack"},Pay:{content:"去付款",rankid:4,isShow:[1,1,1,1,0],style:1,action:"Tuan.pay"}},process:function(e){if(e&&e.TuanOrderItems&&e.TuanOrderItems[0]){var t=e.TuanOrderItems[0];e.RobType="F",e.field="case1",e.TicketStatusesDesc="",t.RobType&&(e.RobType=t.RobType,e.field="Y"==t.RobType?"case2":"case1"),t.TicketStatusesDesc&&(e.TicketStatusesDesc=t.TicketStatusesDesc)}},events:{detail:function(t){if(!e.checkOfflineJump()){var i=r.checkLogin();if(3!==i&&0!==i){var a=e.getJumpUrl(t);return a&&a.indexOf("diyshx")?e.jump(t,a,"index.html#/"):void e.jump(t)}}},payBack:function(t){e.jump(t)},del:function(t){e.del(t,"Tuan")},pay:function(t){e.pay(t,"Tuan")},cancel:function(a){var r=e.getView(),n=$(a.currentTarget).closest("li"),s=n.data("oid"),o=i.TuanOrderCancelModel.getInstance(),l=t.UserStore.getInstance();o.setParam("Operator",{SourceForm:"Online",UID:l.getUser().LoginName}),o.setParam("oid",s),e.cancel(a,o,function(e){if(e&&e.ResponseStatus&&"Success"===e.ResponseStatus.Ack){var t=e.messages&&e.messages[0]?e.messages[0].Text:"订单取消成功";r.showToast({datamodel:{content:t},hideAction:function(){e.status&&1===+e.status&&r.onShow()}})}})}}})}),define("insurecard",["basecard","cGuiderService"],function(e,t){return e.getInstance({bizType:"VacationInsurance",timeConfig:{format:0,entity:"VacationInsuranceOrderItems",collection:["EffectDate","ExpiredDate"],booking:0,relate:!0},handlerConfig:{HideOrder:{content:"删除",rankid:0,isShow:[1,1,0,1,0],style:0,action:"VacationInsurance.del"},Cancel:{content:"取消",rankid:1,isShow:[1,1,0,1,0],style:0,action:"VacationInsurance.detail"},Refund:{content:"退保",rankid:2,isShow:[1,1,0,1,0],style:0,action:"VacationInsurance.detail"},Pay:{content:"去付款",rankid:3,isShow:[1,1,0,1,0],style:1,action:"VacationInsurance.pay"}},events:{detail:function(i){var a=e.getJumpUrl(i);t.apply({callback:function(){Lizard.jump(a+"&"+e.getView().frompageurl)},hybridCallback:function(){t.jump({url:a,targetModel:"h5"})}})},pay:function(t){e.pay(t,"VacationInsurance",function(e){var t=e.PaymentInfos[0].BusType,i=e.PaymentInfos[0].Oid;e.paymentUrl=e.paymentUrl+"&oid="+i+"&bustype="+t})},del:function(t){e.del(t,"VacationInsurance")}}})}),define("cruisecard",["basecard","MyCtripModel"],function(e,t){return e.getInstance({bizType:"Cruise",timeConfig:{format:0,entity:"CruiseOrderItems",collection:["UsageDate"],booking:0},handlerConfig:{CancelOrder:{content:"取消",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Cruise.cancel"},Comment:{content:"点评",rankid:1,isShow:[1,1,0,1,0],style:0,action:"Cruise.guide"},LinkOrder:{content:"关联订单",rankid:2,isShow:[1,1,0,1,0],style:0,action:"Cruise.guide"},ContinueBooking:{content:"继续预订",rankid:3,isShow:[1,1,0,1,0],style:1,action:"Cruise.guide"},ContinuePay:{content:"去付款",rankid:4,isShow:[1,1,0,1,0],style:1,action:"Cruise.guide"}},events:{detail:function(t){e.jump(t)},cancel:function(i){var a=e.getView(),r=t.CruiseCancelOrderModel.getInstance(),n=$(i.currentTarget).closest("li");r.setParam({OrderID:n.data("oid")}),e.cancel(i,r,function(e){"Success"==e.ResponseStatus.Ack?(a.showToast("取消成功"),n.find(".order-status").text("已取消"),n.find(".order-ft").hide()):a.showToast("网络不给力，请稍后再试")})},guide:function(t){e.jump(t)}}})}),define("qichecard",["basecard","CommonStore","cGuiderService"],function(e,t,i){return e.getInstance({bizType:"QiChe",timeConfig:{format:0,entity:"QicheOrderItems",collection:["DepartureDate"],booking:0},handlerConfig:{Pay:{content:"去付款",rankid:4,isShow:[1,1,0,1,0],style:1,action:"QiChe.pay"},Cancel:{content:"取消",rankid:1,isShow:[1,1,1,1,0],style:0,action:"QiChe.detail"},Consult:{content:"在线咨询",rankid:3,isShow:[1,1,1,1,0],style:0,action:"QiChe.consult"},RecommendReturnTicket:{content:"返程推荐",rankid:2,isShow:[1,1,1,0,0],style:0,action:"QiChe.recommend"},Delete:{content:"删除",rankid:0,isShow:[1,1,1,1,0],style:0,action:"QiChe.hideOrder"}},process:function(e){var t=e[this.timeConfig.entity];e.depQicheInfo=t instanceof Array&&t.length?t[0]:{};var i=e.depQicheInfo.DepartureStationName,a=e.depQicheInfo.DepartureCityName,r=e.depQicheInfo.ArrivalStationName,n=e.depQicheInfo.ArrivalCityName;if(e.depQicheInfo.departureDisplayName=i&&0===i.indexOf(a)?i||"":a+i||"",e.depQicheInfo.arrivalDisplayName=r&&0===r.indexOf(n)?r||"":n+r||"",e.depQicheInfo&&e.depQicheInfo.ArriveTime&&e.depQicheInfo.ArriveTime.length>0){var s=e.depQicheInfo.ArriveTime,o=s.match(/^(\d{1,2})\-(\d{1,2})\s+(\d{1,2})\:(\d{1,2})$/),l=function(e){return 10>e?"0"+e:e};e.depQicheInfo.ArriveTime=o?[l(+o[1])+"-"+l(+o[2]),l(+o[3])+":"+l(+o[4])]:""}},events:{detail:function(t){e.jump(t)},pay:function(t){e.pay(t,"QiChe")},consult:function(a){var r=(e.getView(),e.getJumpUrl(a)),n=t.HeadStore.getInstance(),s=n.get().auth||"",o=/(.*[&|?]token=)(\w*)(&?.*)/.exec(r);o&&(r=o[1]+s+o[3]),i.jump({url:r,targetModel:"h5",title:"在线咨询"})},recommend:function(t){e.jump(t)},hideOrder:function(t){e.del(t,"QiChe")}}})}),define("lipincard",["basecard","CommonStore","MyCtripModel","cUtilCommon"],function(e,t,i,a){return e.getInstance({bizType:"Lipin",timeConfig:{format:0,entity:"LipinOrderItems",collection:[],booking:0},handlerConfig:{AbandonRebates:{content:"放弃优惠",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Lipin.abandon"},Shipped:{content:"确认收货",rankid:1,isShow:[1,1,0,1,0],style:1,action:"Lipin.shipped"},ViewReceive:[{content:"领用",rankid:3,isShow:[1,1,0,1,0],style:1,"class":"receive",action:"Lipin.receive"},{content:"查看",rankid:2,isShow:[1,1,0,1,0],style:0,"class":"view",action:"Lipin.view"}],AwaitingPayment:{content:"去付款",rankid:4,isShow:[1,1,0,1,0],style:1,action:"Lipin.pay"},HideOrder:{content:"删除",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Lipin.hideOrder"}},process:function(e){var t=e[this.timeConfig.entity];e.orderInfo=t instanceof Array&&t.length?t[0]:{}},events:{detail:function(t){if(!e.checkOfflineJump()){var i=$(t.currentTarget).closest("li").attr("data-onum"),r=a.isInApp?"/webapp/lipin/#webapp/lipin/orderdetail?onum="+i:"/webapp/lipin/orderdetail?onum="+i;e.jump(t,r,"",!0)}},view:function(t){var i=$(t.currentTarget).closest("li").attr("data-onum"),r=$(t.currentTarget).closest("li").data("oid"),n=a.isInApp?"/webapp/lipin/#webapp/lipin/ordercardpwd?onum="+i+"&oid="+r:"/webapp/lipin/ordercardpwd?onum="+i+"&oid="+r;e.jump(t,n,"",!0)},receive:function(t){var i=$(t.currentTarget).closest("li").attr("data-onum"),r=$(t.currentTarget).closest("li").data("oid"),n=a.isInApp?"/webapp/lipin/#webapp/lipin/ordercardreceive?onum="+i+"&oid="+r:"/webapp/lipin/ordercardreceive?onum="+i+"&oid="+r;e.jump(t,n,"",!0)},abandon:function(t){var a=e.getView(),r=$(t.currentTarget).closest("li"),n=i.LipinAbandonRebateModel.getInstance();n.setParam("OrderID",r.data("oid")),a.showConfirm({datamodel:{content:"放弃优惠后您将可以领用订单中的礼品卡，但您将不会再获得本订单约定赠送的礼品卡，请慎重考虑！",btns:[{name:"点错了",className:"cui-btns-cancel"},{name:"确认放弃",className:"cui-btns-ok"}]},okAction:function(){this.hide(),a.showLoading(),n.execute(function(e){a.hideLoading(),a.showToast(e&&e.Result&&0==e.Result.ResultCode?{datamodel:{content:"操作成功"},hideAction:function(){a.onShow()}}:"操作失败，请稍后再试")},function(){a.hideLoading(),a.showToast("操作失败，请稍后再试")},!0,a,function(){a.hideLoading(),a.showToast("操作失败，请稍后再试")})},cancelAction:function(){this.hide()}})},pay:function(t){e.pay(t,"Lipin")},shipped:function(t){var a=e.getView(),r=$(t.currentTarget).closest("li"),n=i.CustomerLipinConfirmModel.getInstance(),s=r.data("cnt");a.showConfirm({datamodel:{content:"您确认已收到"+s+"张礼品卡（实体卡）？",btns:[{name:"取消",className:"cui-btns-cancel"},{name:"确定",className:"cui-btns-ok"}]},okAction:function(){this.hide(),n.setParam({OrderId:r.data("oid")}),n.excute(function(e){a.hideLoading(),e.ResultInfo.IsSuccessful?(a.onShow(),a.showToast("确认收货成功")):a.showToast(e.ResultInfo.ResultMessage)},function(){a.hideLoading(),a.showToast("网络不给力，请稍候重试")},!0,a,function(){a.hideLoading(),a.showToast("网络不给力，请稍候重试")})},cancelAction:function(){this.hide()}})},hideOrder:function(t){e.del(t,"Lipin")}}})}),define("traincard",["basecard","CommonStore","cGuiderService","cUtilHybrid","MyCtripModel"],function(e,t,i,a,r){return e.getInstance({bizType:"Train",timeConfig:{format:0,entity:"TrainOrderItems",collection:[{field:"DepartureDateStr",name:"DepartureDate",format:""},{field:"ArrivalDateStr",name:"ArrivalDate",format:""},{field:"DepartureDateStr",name:"BackDepartureDate",format:""},{field:"ArrivalDateStr",name:"BackArrivalDate",format:""}],booking:0},handlerConfig:{OrderPay:{content:"去支付",rankid:5,isShow:[1,1,0,1,0],style:1,action:"Train.pay"},OrderConsult:{content:"咨询",rankid:4,isShow:[1,1,1,1,0],style:0,action:"Train.consult"},RefundTicket:{content:"退票",rankid:2,isShow:[1,1,1,1,0],style:0,action:"Train.detail"},Share:{content:"分享",rankid:3,isShow:[1,0,1,1,0],style:0,action:"Train.share"},CancelOrder:{content:"取消",rankid:1,isShow:[1,1,1,1,0],style:0,action:"Train.detail"},HideOrder:{content:"删除",rankid:0,isShow:[1,1,1,1,0],style:0,action:"Train.del"},Refund:{content:"退票",rankid:2,isShow:[1,1,1,1,0],style:0,action:"Train.process"},Cancel:{content:"取消",rankid:1,isShow:[1,1,1,1,0],style:0,action:"Train.process"},Payment:{content:"去付款",rankid:4,isShow:[1,1,0,1,0],style:1,action:"Train.detail"}},process:function(e){var t=e[this.timeConfig.entity],i=t.length;if(e.timeIndexes=[0,0],e.carriageSeat="",e.isTypeReturn=!1,e.depTrainInfo=t instanceof Array&&i?t[0]:{},"Train"===e.BizType&&i>0){for(var a=[],r="",n="",s="",o=0;i>o;o++)r=t[o].CarriageNo?t[o].CarriageNo+"车":"",n=t[o].SeatNo?t[o].SeatNo:"",s=r+n,s.length>0&&a.push(s);a.length&&(e.carriageSeat=a[0]+(void 0!==a[1]&&Passagers&&Passagers.length>1?"、"+a[1]:"")+(a.length>2?"等":""))}if("TrainInternational"===e.BizType&&i>0){var l=t.Validity?0:"返程"===t[i-1].WayType?2:1,d=!1;if(e.isTypeReturn=2===l,1==l)e.timeIndexes=[0,i-1];else if(l=2)for(o=0;i>o;o++)"去程"===t[o].WayType?e.timeIndexes[1]=o:"返程"===t[o].WayType&&(d||(e.timeIndexes[2]=o,d=!0),e.timeIndexes[3]=o)}e.arrTrainInfo=e.isTypeReturn&&d?t[e.timeIndexes[2]]:null;var c=["已购票","已配送","已成交"],p=e.OrderStatusName||"";e&&e.OrderActions&&!e.isOfflineOrder&&"TrainInternational"!=e.BizType&&$.inArray(p,c)>-1&&e.OrderActions.push({ActionCode:"Share",ActionName:"分享"})},afterFilterData:function(e){if(e.shareItem="",e&&e.TrainOrderItems&&e.TrainOrderItems[0]&&e.ArrivalDate&&e.DepartureDate&&e.Passagers){var t=e.Passagers.length,i="";t&&(i=(e.Passagers[0]||"")+(e.Passagers[0]&&e.Passagers[1]?"、":"")+(e.Passagers[1]||"")+(t>2?"等":"")),e.shareItem=[e.TrainOrderItems[0].DepartureStation||"",e.TrainOrderItems[0].ArrivalStation||"",e.DepartureDate[0]+"日"+e.DepartureDate[1],e.ArrivalDate[0]+"日"+e.ArrivalDate[1],e.TrainOrderItems[0].TrainNumber||"",i?"，出行人是"+i:""].join("|")}},events:{detail:function(t){if(!e.checkOfflineJump()){var r=e.getView(),n=$(t.currentTarget).closest("li").data("oid");"youth"===a.getAppSys()?i.cross({path:"train",param:"index.html#bookingdetails?orderId="+n+"&"+r.frompageurl}):e.jump(t)}},share:function(t){var i=$(t.currentTarget).closest("li").data("share").split("|")||"";if(i instanceof Array){var a=i[0]+"到"+i[1]+"火车票",r="携程旅行客户端帮我预订了从"+i[0]+"至"+i[1]+"，"+i[2]+"出发至"+i[3]+"到达，车次是"+i[4]+i[5]+"。";e.share({title:a,text:r})}},del:function(t){e.del(t,"Train")},pay:function(t){var i=$(t.currentTarget).closest("li").data("type");e.pay(t,i)},consult:function(a){var r=t.HeadStore.getInstance(),n=r.get().auth||"",s=e.getJumpUrl(a);s+=(s.indexOf("?")>-1?"&":"?")+"token="+n,i.jump({url:s,targetModel:"h5",title:"订单咨询"})},process:function(t){var i={Cancel:{reason:"用户申请取消",confirmText:"您确定要取消这张订单？",successText:"操作成功",okText:"<strong>取消订单</strong>",model:r.CancelOrder.getInstance()},Refund:{reason:"用户申请退订",confirmText:"您的订单已出票，现在退票可能会产生金额损失，详情请参考退改签政策，是否确认退票？",successText:"您的退票申请已提交，稍后会有订单操作人员与您联系并办理退票事宜。",okText:"<strong>确认退票</strong>",model:r.RecedeOrder.getInstance()}},a=e.getView(),n=$(t.currentTarget).closest("li").data("oid"),s=$(t.currentTarget).data("code"),o=i[s].reason,l=i[s].model;l.setParam({OrderID:n,Reason1:o}),a.showConfirm({datamodel:{content:i[s].confirmText,btns:[{name:"点错了",className:"cui-btns-cancel"},{name:i[s].okText,className:"cui-btns-ok"}]},okAction:function(){this.hide(),a.showLoading(),l.execute(function(e){a.hideLoading(),a.showToast(e&&0==e.ResultCode?{datamodel:{content:i[s].successText},hideAction:function(){a.onShow()}}:"操作失败，请稍后再试")},function(){a.hideLoading(),a.showToast("操作失败，请稍后再试")},!0,a,function(){a.hideLoading(),a.showToast("操作失败，请稍后再试")})},cancelAction:function(){this.hide()}})}}})}),define("diycard",["basecard"],function(e){return e.getInstance({bizType:"DIY",timeConfig:{format:0,entity:"DIYOrderItems",collection:["BeginUsageDate","EndUsageDate"],booking:0,relate:!0},handlerConfig:{HideOrder:{content:"删除",rankid:1,isShow:[1,1,0,1,0],style:0,action:"DIY.hideOrder"}},events:{detail:function(t){e.jump(t)},hideOrder:function(t){e.del(t,"DIY")},modify:function(t){e.jump(t)}}})}),define("sceneryhotelcard",["basecard"],function(e){return e.getInstance({bizType:"SceneryHotel",timeConfig:{format:0,entity:"PiaoOrderItems",collection:["DepartureDate"],booking:0},handlerConfig:{HideOrder:{content:"删除",rankid:1,isShow:[1,1,0,1,0],style:0,action:"SceneryHotel.hideOrder"}},events:{detail:function(t){e.jump(t,"","index.html#/")},hideOrder:function(t){e.del(t,"SceneryHotel")}}})}),define("visacard",["basecard","cUtilCommon","cGuiderService"],function(e,t,i){return e.getInstance({bizType:"Visa",timeConfig:{format:0,entity:"VisaOrderItems",collection:["DepartureDate"],booking:0},handlerConfig:{ToPay:{content:"去付款",rankid:8,isShow:[1,1,0,1,0],style:1,action:"Visa.pay"},ModifyOrder:{content:"修改",rankid:7,isShow:[1,1,0,1,0],style:0,action:"Visa.detail"},ModifyInvoice:{content:"修改发票",rankid:6,isShow:[1,1,0,1,0],style:0,action:"Visa.detail"},Modify:{content:"修改联系人",rankid:5,isShow:[1,1,0,1,0],style:0,action:"Visa.detail"},Cancel:{content:"取消",rankid:2,isShow:[1,1,0,1,0],style:0,action:"Visa.detail"},HideOrder:{content:"删除",rankid:1,isShow:[1,1,0,1,0],style:0,action:"Visa.del"}},events:{detail:function(t){var a=e.getJumpUrl(t)+"&"+e.getView().frompageurl;i.apply({callback:function(){Lizard.jump(a)},hybridCallback:function(){i.jump({url:a,targetModel:"h5",title:""})}})},del:function(t){e.del(t,"Visa")},pay:function(i){e.pay(i,"Visa",function(e){if(e.paymentUrl&&t.isInApp){var i=/.*(\/webapp\/)(\w*)(\/)(.*)/,a=i.exec(e.paymentUrl);a&&a[4]&&a[4].indexOf("index.html")<0&&(a[4]="#"==a[4][0]?"index.html"+a[4]:"index.html#"+a[4],e.paymentUrl=a[1]+a[2]+a[3]+a[4])}})}}})}),define("airbuscard",["basecard","MyCtripModel"],function(e,t){return e.getInstance({bizType:"AirportBus",timeConfig:{format:0,entity:"AirportBusOrderItems",collection:[],booking:0},handlerConfig:{Cancel:{content:"取消",rankid:1,isShow:[1,1,0,1,0],style:0,action:"AirBus.cancel"},RefundTicket:{content:"退票",rankid:2,isShow:[1,1,0,1,0],style:0,action:"AirBus.payBack"},ToPay:{content:"去付款",rankid:3,isShow:[1,1,0,1,0],style:1,action:"AirBus.pay"},Delete:{content:"删除",rankid:1,isShow:[1,1,0,1,0],style:0,action:"AirBus.del"}},process:function(e){var t=e[this.timeConfig.entity];if(e.depAirbusInfo=t instanceof Array&&t.length?t[0]:{},e.TicketNumber="","已退票"===e.OrderStatusName)return e.TicketNumber;if(e&&e.AirportBusOrderItems[0]&&e.AirportBusOrderItems[0].TicketNumber){var i=e.AirportBusOrderItems[0].TicketNumber.split("、");e.TicketNumber=i.length>1?i[0]+"等":i[0]}},events:{pay:function(t){e.pay(t,"AirportBus")},detail:function(t){e.jump(t)},payBack:function(t){e.jump(t)},del:function(t){e.del(t,"AirportBus")},cancel:function(i){var a=e.getView(),r=$(i.currentTarget).closest("li"),n=t.AirportbusCancelModel.getInstance();n.setParam({OrderID:r.data("oid")}),e.cancel(i,n,function(e){a.showToast(e&&"Success"==e.ResponseStatus.Ack&&0==e.RetCode?{datamodel:{content:"取消成功"},hideAction:function(){a.onShow()}}:"取消失败，请稍后再试")})}}})}),define("golfcard",["basecard","cUtilHybrid"],function(e){return e.getInstance({bizType:"Golf",timeConfig:{format:0,entity:"GolfOrderItems",collection:["UsageDate"],booking:0},handlerConfig:{},events:{detail:function(t){var i=e.getView().frompageurl,a=e.getJumpUrl(t);return window.location.host.match(/^m\.fat\d*\.qa\.nt\.ctripcorp\.com|^210\.13\.100\.191/i)?(a+=a.indexOf("?")>-1?"&":"?",Lizard.jump(a+i)):void e.jump(t)}}})}),define("hhtravelcard",["basecard"],function(e){return e.getInstance({bizType:"HHTravel",timeConfig:{format:1,entity:"HHTravelOrderItems",collection:["UsageDate"],booking:0},handlerConfig:{},events:{detail:function(t){e.jump(t)}}})}),define("mallcard",["basecard","MyCtripModel"],function(e){return e.getInstance({bizType:"Mall",timeConfig:{format:0,entity:"MallOrderItems",collection:[],booking:0},handlerConfig:{ContinuePay:{content:"去付款",rankid:3,isShow:[1,1,0,1,0],style:1,action:"Mall.pay"},DeleteOrder:{content:"删除",rankid:0,isShow:[1,1,0,1,0],style:0,action:"Mall.DeleteOrder"}},process:function(e){e.items=e[this.timeConfig.entity]||[],e.items&&(e.Point=e.items[0].Point,e.ProductName=e.items[0].ProductName||"",e.ProductDesc=e.items[0].ProductDesc||"",e.Quantity=e.items[0].Quantity||"",e.ImageURL=e.items[0].ImageURL||"")},events:{pay:function(t){e.pay(t,"Mall")},detail:function(t){e.jump(t,"","",!0)},DeleteOrder:function(t){e.del(t,"Mall")}}})}),define("globalbuycard",["basecard","MyCtripModel"],function(e,t){return e.getInstance({bizType:"GlobalBuy",timeConfig:{format:0,entity:"GlobalBuyOrderItems",collection:[],booking:0},handlerConfig:{Pay:{content:"去付款",rankid:3,isShow:[1,1,0,1,0],style:1,action:"GlobalBuy.pay"},AddView:{content:"点评",rankid:3,isShow:[1,1,0,1,0],style:0,action:"GlobalBuy.AddView"},ViewDetail:{content:"查看点评",rankid:3,isShow:[1,1,0,1,0],style:0,action:"GlobalBuy.ViewDetail"},Delete:{content:"删除",rankid:3,isShow:[1,1,0,1,0],style:0,action:"GlobalBuy.Delete"},Cancel:{content:"取消",rankid:3,isShow:[1,1,0,1,0],style:0,action:"GlobalBuy.Cancel"},Done:{content:"确认收货",rankid:3,isShow:[1,1,0,1,0],style:0,action:"GlobalBuy.Done"}},process:function(e){e.items=e[this.timeConfig.entity]||[],e.items&&(e.SiteName=e.items[0].SiteName||"",e.VendorName=e.items[0].VendorName||"");var t=_.map(e.items,function(e){return e.Quantity});e.total=_.reduce(t,function(e,t){return e+t},0),e.Quantity=e.items.length,e.isMultiple=e.Quantity>1?!0:!1},events:{pay:function(t){e.pay(t,"GlobalBuy")},detail:function(t){e.jump(t)},AddView:function(t){var i=e.getJumpUrl(t);e.jump(t,i)},ViewDetail:function(t){var i=e.getJumpUrl(t);e.jump(t,i)},Delete:function(t){e.del(t,"GlobalBuy")},Cancel:function(i){var a=e.getView(),r=$(i.currentTarget).closest("li"),n=t.GlobalBuyCancelModel.getInstance();n.setParam({OrderID:r.data("oid"),OrderStatus:5}),e.cancel(i,n,function(e){a.showToast(e&&"Success"==e.ResponseStatus.Ack&&0==e.RetCode?{datamodel:{content:"取消成功"},hideAction:function(){a.onShow()}}:"取消失败，请稍后再试")})},Done:function(t){e.jump(t)}}})}),define("depositcard",["basecard"],function(e){return e.getInstance({bizType:"Deposit",timeConfig:{format:0,entity:"DepositOrderItems",collection:["DepositTimeFrom","DepositTimeTo"],booking:0},handlerConfig:{ContinuePay:{content:"去付款",rankid:1,isShow:[1,1,0,1,0],style:0,action:"Deposit.pay"}},events:{detail:function(t){e.jump(t)},pay:function(t){e.pay(t,"Deposit")}}})}),define("dnrcard",["basecard"],function(e){return e.getInstance({bizType:"Dnr",timeConfig:{format:0,entity:"DnrOrderItems",collection:["BeginUsageDate","EndUsageDate"],booking:0,relate:!0},handlerConfig:{},events:{detail:function(t){e.jump(t)}}})}),define("cardloader",["basecard","flightcard","topshopcard","hotelcard","vacationcard","carcard","piaocard","activitycard","taxicard","tuancard","insurecard","cruisecard","qichecard","lipincard","traincard","diycard","sceneryhotelcard","visacard","airbuscard","golfcard","hhtravelcard","mallcard","globalbuycard","depositcard","dnrcard"],function(e){return e.init(),e}),define("indexCommon",["MyCtripModel","cHybridShell","cardloader"],function(e,t,i){var a=e.GetMessageListsModel.getInstance(),r=e.UserInfoModel.getInstance(),n=e.OrderStatusModel.getInstance(),s=e.OrdersSearchModel.getInstance(),o=e.favoriteModel.getInstance(),l={0:[0,"普通","ordinary"],10:[2e3,"金牌","gold"],20:[8e3,"白金","platinum"],30:[2e4,"钻石","diamond"]},d=function(e){var t=new Date,i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in i)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[a]:("00"+i[a]).substr((""+i[a]).length)));return e},c={handleBaseUserInfo:function(){var e=localStorage.getItem("USERINFO"),t=e&&JSON.parse(e);if(t=t&&t.data,t&&"undefined"!=typeof t.VipGrade&&"undefined"!=typeof t.UserName){var i=t.UserName?t.UserName:"尊敬的会员",a=["普通","金牌"],r=+t.VipGrade>0&&+t.VipGrade<10?10:+t.VipGrade;return a=[l[30===+r?20:+r][1],l[30===+r?30:+r+10][1]],{userName:i,grade:l[r][2],lvlName:l[r][1]+"会员",degree:a}}},requestMessageInfo:function(e){var t="";t=0===window.deviceEnv?"ONLINE":"MOBILE",a.setParam({ChannelType:t,EndTime:d("yyyy-MM-dd hh:mm:ss")}),a.excute(function(t){t&&"成功"===t.ResultMessage&&0===t.ResultCode&&"function"==typeof e&&e(t)},function(e){},!0,this,function(e){})},orientationChange:function(){window.addEventListener("orientationchange",function(){i.relayoutButton()})},requestBalanceInfo:function(e){var t={balanceInfo:{MerchantBalance:"",Gift:"",Cash:"",Promocode:"",Point:"",GroupTicketCount:""},lvlProgress:"",avatarUrl:""};r.excute(function(i){var a=0;if(i&&i.Result&&0==i.Result.ResultCode){if(i.MemberAssetSummaries&&i.MemberAssetSummaries instanceof Array)for(var r=0,n=i.MemberAssetSummaries.length;n>r;r++){var s=i.MemberAssetSummaries[r];if(s.AssetType){var o=s.AssetType,d="MerchantBalance"==o?+s.Balance/100:+s.Balance,c="";if("MerchantBalance"==o||"Gift"==o||"Cash"==o)if(d=d.toFixed(2),d>1e5)c=">10万";else if(1e5==d)c="¥10万";else{var p="Cash"==o?!1:d-parseInt(d)>0;c=p?"¥"+d:"¥"+parseInt(d)}else"Promocode"==o||"Point"==o||"GroupTicketCount"==o?c=d:"BasicPoint"==o&&(c="基本积分："+d,a=d);t.balanceInfo[s.AssetType]=c}}if("number"==typeof+i.Grade){var u=+i.Grade<10?0:+i.Grade,f="0%";if("undefined"!=typeof a){var h=l[30===+u?20:+u][0],m=l[30===+u?30:+u+10][0];if(a>h&&m>=a){var g=a-h,y=m-h;f=100*(g/y).toFixed(2)+"%"}else a>m&&(f="100%");t.lvlProgress=f}}if(i.AvatarNameEntities&&i.AvatarNameEntities instanceof Array){var v=i.AvatarNameEntities[0];if(v&&v.URL){for(var b=[".jpg",".jpeg",".jpe",".jfif",".gif",".png"],w=0,T="",r=0;r<b.length;r++)if(v.URL.indexOf(b[r])>-1){w=v.URL.indexOf(b[r]),T=v.URL.substr(0,w)+v.URL.substr(w);break}t.avatarUrl=T}}"function"==typeof e&&e(t)}},function(e){},!0,this,function(e){})},orderCount:function(e){n.setParam("OrderStatisticsGroups",[{GroupName:"NotTravel"},{GroupName:"AwaitPay"},{GroupName:"AwaitReview"}]),n.excute(function(t){var i={};if(t&&t.Result&&0==t.Result.ResultCode){if(t.OrderStatisticsGroupList&&t.OrderStatisticsGroupList.length){var a=t.OrderStatisticsGroupList;for(var r in a)a[r]&&a[r].GroupName&&"undefined"!=typeof a[r].Count&&(i[a[r].GroupName]=a[r].Count)}"function"==typeof e&&e(i)}},function(e){},!0,this,function(e){})},setHead:function(e){e.setTitle("我的携程"),e.headerview.set({title:"我的携程",back:!0,view:e,events:{returnHandler:function(){Guider.jump({url:"ctrip://wireless/home",targetModel:"app"})}}}),e.headerview.show()},resetUserInfo:function(e){var i=function(){t.Fn("member_auto_login",function(t){if(t||(localStorage.removeItem("USERINFO"),localStorage.removeItem("USER"),cPublic.ctripMenu({show:!1,buName:"home"}),e.renderTpl(),e.onShow()),t.data&&t.data.headIcon){var i=e.$el.find(".member-pic").find("img")[0];i.src=t.data.headIcon}}).run()};t.upon("web_view_did_appear",i)},filterOrderData:function(e,t,a){i.setView(e,0===deviceEnv),i.initForPad(),s.setParam(t),s.abort();var r={resultCode:0};s.excute(function(e){var t=e.OrderEnities;if(e&&e.Result&&0==e.Result.ResultCode){var n="";if(t.length>0){for(var s=0,o=t.length;o>s;s++)n+=i.render(t[s]);$.extend(r,{htmlStr:n})}"undefined"!=typeof e.TotalCount&&$.extend(r,{orderCount:e.TotalCount})}else $.extend(r,{resultCode:1});"function"==typeof a&&a(r)},function(){$.extend(r,{resultCode:1}),"function"==typeof a&&a(r)},!0,this,function(e){})},filterfavoriteData:function(e,t){var i={resultCode:0};o.setParam(e),o.excute(function(e){var a="";if(e&&0==e.ResultCode){if(e.FavoriteList&&e.FavoriteList.length)for(var r=e.FavoriteList,n=0;n<e.FavoriteList.length;n++)a+=this.favoriteRender(r[n]);$.extend(i,{htmlStr:a}),"function"==typeof t&&t(i)}else $.extend(i,{resultCode:1}),"function"==typeof t&&t(i)},function(){$.extend(i,{resultCode:1}),"function"==typeof t&&t(i)},!0,this,function(e){})},favoriteRender:function(e){var t="",i=!1;if(e){var a=" data-statusid='"+("undefined"==typeof e.StatusID?"":e.StatusID)+"'",r=" data-biz='"+(e.BizType.toLowerCase()||"")+"'",n=" data-url='"+(0===deviceEnv?e.Url:Lizard.isHybrid?e.UrlForApp:e.UrlForH5)+"'",s=e.PicUrl||"",o=e.ProductName||"",l=e.Star||0,d=e.CommentScore||0,c=e.Price||"0",p=e.ProductType||e.BizType||"",u="";if(p){var f={HOTEL_DOMESTIC:{name:"酒店"},HOTEL_INTERNATIONAL:{name:"酒店"},VIEW_HOTEL:{name:"景+酒"},GROUP_TRAVEL:{name:"团队游"},CRUISE:{name:"邮轮"},TUAN_HOTEL:{name:"酒店"},TUAN_TRAVEL:{name:"旅游"},TUAN_TICKET:{name:"门票"},TUAN_LIFE:{name:"餐饮"},HIGH_MERCHANT:{name:"商户"},HIGH_PACKAGE:{name:"套餐"},DEST_FOOD:{name:"美食"},DEST_LIFE:{name:"娱乐"},DEST_SHOPPING:{name:"购物"},DEST_VIEWSPOT:{name:"景点"},DEST_ITINERARY:{name:"行程"},DEST_JOURNAL:{name:"游记"},GLOBAL_SHOPPING:{name:"全球购"},VISA:{name:"签证"},WEEKEND:{name:"周末游"},PLANE_HOTEL:{name:"自由行"},WEEKEND_ACTIVITY:{name:"周末游"},WEEKEND_VIEWHOTEL:{name:"周末游"},TICKET:{name:"门票"},ACTIVITY:{name:"玩乐"}};for(var h in f)if(p===h&&f[p]){u=f[p].name,i=!0;break}}if(!i)return t;t="<li"+a+r+n+'><div class="fav-pic"><span class="fav-tag">'+u+'</span><img width="90" height="90" src="'+s+'" alt=""></div><h4>'+o+'</h4><p><span class="fav-diamond fav-diamond0'+l+'"></span></p><p class="fav-score"><em>'+d+'分</em>/5分</p><span class="fav-price">¥<em>'+c+"</em>起</span></li>"}return t},showLocalLoading:function(e){$(e).height()<240&&$(e).css("height","240px");var t=new cPublic.network({parent:e});t.loading()},showErrorTpl:function(e,t){var i=new cPublic.network({parent:e,left:200,right:200});i.loadFailed(function(e){e(),"function"==typeof t&&t()})}};return c}),define("commonlist",["CommonStore","cPageList","MyCtripModel","MyCtripStore","cUtilCommon","cHybridShell","cGuiderService","cLocalStorage","cardloader","myctripCommon","cMemberService","UIBubbleLayer",loadModule("orderTypes"),loadModule("pagination","online")],function(e,t,i,a,r,n,s,o,l,d,c,p,u){var f=i.OrdersSearchModel.getInstance(),h=i.OrderNumbersModel.getInstance(),m={getInstance:function(n){if(!n||"undefined"===n.viewType||"undefined"===n.title){var o=["viewType","title"],p=[];o.forEach(function(e){n.hasOwnProperty(e)||p.push(e)})}n.init&&"function"==typeof n.init&&n.init(),n.entityName||(n.entityName="OrderEnities"),n.from||(n.from="from="+encodeURIComponent("/webapp/myctrip/orders/"+n.viewType));var m=["onCreate","onShow","showView","onHide","onBottomPull"],g=e.UserStore.getInstance(),y=a.OrderlistBackStore.getInstance(),v=t,b=v.extend({pageid:n.pageid,hpageid:n.hpageid,bizType:n.bizType||!1,viewType:n.viewType,listModel:n.listModel||f,unionType:n.unionType||!1,pageNum:1,isOnline:d.isOnline,pageSize:d.isOnline?10:25,totalPage:void 0,bNoMore:!1,bLoading:!1,bTopPulling:!1,loginStatus:d.checkLogin(),frompageurl:n.from,onCreate:function(){2===this.loginStatus&&d.isJoinMobileSearch(this.bizType)&&this._newUnlogin();for(var e in n)n.hasOwnProperty(e)&&-1===$.inArray(e,m)&&(this[e]=n[e]);n.onCreate&&"function"==typeof n.onCreate&&n.onCreate(this)},onShow:function(){if(l.setView(this,this.isOnline),isShowSlideMenu&&1===this.loginStatus&&(cPublic.ctripMenu({show:!0,buName:"order"}),l.initForPad()),this.isOnline||this.bCustomizeHead||this.showHead(),this.frompageurl="from="+encodeURIComponent("/webapp/myctrip/orders/"+this.viewType),this.isAggregated="allorders"==this.viewType||"unpaidorderlist"==this.viewType||"unuseorderlist"==this.viewType||"uncommentorderlist"==this.viewType||"searchresult"==this.viewType?!0:!1,!n.onShow||"function"!=typeof n.onShow||!n.onShow(this)){var e=Lizard.P("from");if(e&&"offline"!==e){var t=y.get();t||(t={}),t[this.viewType]=e,y.set(t)}this.showView()}},showView:function(){this.pageNum=1,this.bNoMore=!1,this.bLoadedOrdersCount=!1;var e="order-bg ",t="";if(this.isOnline?e+="other_wrap":(e+="sub-viewport",t="order-wrap"),this.$el.addClass(e).html('<section class="'+t+'"><ul id="'+this.viewType+'" class="order-list" style="min-height:380px"></ul></section>'),this.elsBox={lstbox:this.$el.find("#"+this.viewType)},u.append(this,d.getOrderTypeList(this.isOnline)),this._showPadHead(),this.bNoNeedCheckLogin||this._checkLogin()){if(n.showView&&"function"==typeof n.showView&&n.showView(this))return;this.listModel.setParam({PageSize:this.pageSize,BizTypes:this.bizType||"",OrderStatusClassify:this.unionType||"All",Channel:this.isOnline?"Online":Lizard.isHybrid?"Hybrid":"H5"}),isShowSlideMenu&&["unpaidorderlist","unuseorderlist","uncommentorderlist"].indexOf(this.viewType)>-1&&Lizard.P("viewtype")&&Lizard.P("biztype")&&this.listModel.setParam("BizTypes",Lizard.P("biztype")),this.loadData()}},loadData:function(){var e=this,t=1===this.pageNum?!0:!1;this.bLoadDataError=!1,n.onBeforeRequest&&"function"==typeof n.onBeforeRequest&&n.onBeforeRequest(this,t)||(this.bTopPulling?this.showTopLoading():this.isOnline?this._showLoading():t?this._showLoading():this.showBottomLoading(),this.bLoading=!0,this.listModel.setParam("PageIndex",this.pageNum),t&&delete this.listModel.param.BookingDateTime,this.listModel.excute(function(i){if(!n.onAfterRequest||"function"!=typeof n.onAfterRequest||!n.onAfterRequest(e,i,t))if(i&&i.Result&&0==i.Result.ResultCode){if("undefined"==typeof i.TotalCount&&(i.TotalCount=i.totalcount),t&&(e.totalPage=Math.ceil(i.TotalCount/e.pageSize),e._setTitleNumber(i.TotalCount),this.bTopPulling&&this.elsBox.lstbox.html("")),e.renderList(i,t),e.pageNum++,e.isAggregated){var a=i[e.entityName];
if(a&&a.length>0){var r=a[a.length-1];r&&r.BookingDate&&e.listModel.setParam("BookingDateTime",r.BookingDate)}}e._complete()}else e._error(i,!0,t)},function(i){e._error(i,!1,t)},!0,e,function(i){e._error(i,!1,t)}))},renderList:function(e,t){var i=this,a="",r=e[this.entityName],s="";if(t&&this.totalPage<=0){if(this.$el.removeClass("order-bg"),"searchresult"===this.viewType)this.elsBox.lstbox.append('<div class="search-noresult"><i class="i-search-noresult"></i><p>没有找到符合条件的结果，<br />请修改条件重新查询。</p></div>');else{var o="";o=this.emptyText?this.emptyText:"暂时没有相关订单",this.elsBox.lstbox.html('<div class="noorder"><p><i class="i-noorder"></i></p><p>'+o+"</p></div>")}this.bNoMore=!0}else{if(r&&$.isArray(r)&&r.length>0)for(var d=0,c=r.length;c>d;d++)s=l.render(r[d]),"undefined"!=typeof s&&(a+=s);if(this.isOnline?this.elsBox.lstbox.html(a):this.elsBox.lstbox.append(a),n.onAfterRender&&"function"==typeof n.onAfterRender&&n.onAfterRender(i))return;this.pageNum>=this.totalPage&&(this.elsBox.lstbox.append($("<p class='nomore'>没有更多订单了</p>")),this.bNoMore=!0),t&&(window.scrollTo(0,1),window.scrollTo(0,0)),this.isOnline&&t&&(this.$el.find(".paging_box").remove(),this.$el.children("section").append($('<div class="paging_box"><div class="paging"></div></div>')),$(".paging_box").pagination(e.TotalCount,{callback:function(e){i.pageNum=e+1,i.elsBox.lstbox.empty(),i.loadData()},prev_text:"&nbsp;",next_text:"下一页 ",items_per_page:10,num_display_entries:5,current_page:0,num_edge_entries:1,view:i}))}},_error:function(e,t,i){var a=this;if(this.bLoadDataError=!0,this._complete(),d.sendUbtTrace({traceName:"myctrip_order",pageId:a.hpageid,pageName:a.viewType,bServerError:t,err:e}),!n.onError||"function"!=typeof n.onError||!n.onError(this,e,t,i))if(1===this.pageNum){a.bNoMore=!0;var r=new cPublic.network({parent:"#"+this.viewType});r.loadFailed(function(e){e(),a.showView()})}else{var s=new cPublic.prompt({message:{title:"",content:"加载失败，请稍后再试"},autoHide:!0,timeout:1e3});s.prompt()}},_complete:function(){this.bLoading=!1,this._hideLoading(),this.hideBottomLoading(),this.bTopPulling&&(this.bTopPulling=!1,this.hideRefreshLoading())},_newUnlogin:function(){n.listModel=i.UnLoginGetOrderModel.getInstance(),n.entityName="OrderEnities",n.onBack=function(){return Lizard.goTo("/webapp/myctrip/orders/ordertypelist"),!0}},_showLoading:function(){var e=new cPublic.network({parent:"#"+this.viewType,position:"relative"});this.closeloading=e.loading(function(e){return e}),this.$el.find(".cp-h5-main").css("height",$("#main").height()-(r.isInApp?21:65))},_hideLoading:function(){"function"==typeof this.closeloading&&this.closeloading()},onHide:function(){n.onHide&&"function"==typeof n.onHide&&n.onHide(this)||(this.listModel.setParam({BookingDateTime:"",PageSize:1,BizTypes:"",OrderStatusClassify:""}),this.removeScrollListener(),this.hideBottomLoading(),this.hideWarning404(),r.isInApp||this.listModel.abort(),u.hide(this),this.bTopPulling=!1)},onTopPull:function(){this.bTopPulling||(this.pageNum=1,this.bNoMore=!1,this.bTopPulling=!0,n.onTopPulling&&"function"==typeof n.onTopPulling&&n.onTopPulling(this)||this.loadData())},onBottomPull:function(){return this.isOnline?void 0:this.bNoMore||this.bLoading?void this.endPull():void(this._checkLogin()&&(n.onBottomPull&&"function"==typeof n.onBottomPull&&n.onBottomPull(this)||this.loadData()))},showHead:function(){var e=this,t={back:!0,view:e,events:{returnHandler:function(){var t=Lizard.P("from"),i=y.get();i&&i[e.viewType]&&(t||(t=i[e.viewType]),delete i[e.viewType],y.set(i)),t&&(t=t.replace(/javascript|img/gi,"").replace(/\<|\>/g,""),t=decodeURIComponent(t),"offline"===t.toLowerCase()&&(t="")),e.onBack&&"function"==typeof e.onBack&&e.onBack(e,t)||s.apply({hybridCallback:function(){if(t)Lizard.jump(t);else{var i=Lizard.P("from_native_page");"1"===i&&"insureorderlist"!==e.viewType?s.backToLastPage():isShowSlideMenu?Lizard.jump("/webapp/myctrip/index"):s.jump({targetModel:"app",module:"myctrip"})}},callback:function(){Lizard.jump(t?t:Lizard.appBaseUrl)}})},citybtnHandler:function(t){1!=this.loginStatus?Lizard.goTo("/webapp/myctrip/orders/ordertypelist"):u.show(e,t,h)}}};if(isShowSlideMenu?t.title=this.title:t.citybtn=this.title,!isShowSlideMenu){var i=g?g.getUser():null;if(i&&!i.IsNonUser&&("allorders"==e.viewType||"hotelorderlist"==e.viewType||"flightorderlist"==e.viewType)){var a=location.href.indexOf("?")>-1?location.href.slice(location.href.indexOf("?")):"";(!a||a.indexOf("searchfrom")<0)&&(a="?searchfrom="+e.viewType),t.right=[{tagname:"custom",value:"查找",callback:function(){(void 0===e.totalPage||e.totalPage>0)&&Lizard.jump(Lizard.appBaseUrl+"orders/search"+a)}}]}}e.header.set(t)},_showPadHead:function(){if(isShowSlideMenu&&"searchresult"!==this.viewType&&1===this.loginStatus&&!this.$el.find(".order-header").length){var e=isShowSlideMenu?Lizard.P("viewtype")||this.viewType:this.viewType,t=this._getOrderNumberRequestParam(e),a=this,r="",n="",s="",o="",l="",c=d.getOrderTypeList(this.isOnline),p="",f={allorders:{name:"全部订单",url:"orders/allorders"}},m='<div class="order-header"><ul class="orders-status-filter">';t.AwaitPay&&(f.unpaidorderlist={name:"待付款",url:"orders/unpaidorderlist",group:"AwaitPay"}),t.NotTravel&&(f.unuseorderlist={name:"未出行",url:"orders/unuseorderlist",group:"NotTravel"}),t.AwaitReview&&(f.uncommentorderlist={name:"待评价",url:"orders/uncommentorderlist",group:"AwaitReview"});for(var g in f)if(f.hasOwnProperty(g)){if("allorders"===g){var y=null,v=a.bizType;v=Lizard.P("biztype")||v;for(var b=0,w=c.length;w>b;b++)if(y=c[b],y.biztype instanceof Array){if(y.biztype.length===v.length&&(y.biztype.sort(),v.sort(),y.biztype.toString()==v.toString())){n=y.name,s=y.url;break}}else if(y.biztype===v){n=y.name,s=y.url;break}b===w&&(n="全部订单",s="orders/allorders"),r=-1===["unpaidorderlist","unuseorderlist","uncommentorderlist"].indexOf(a.viewType)?' class="filter-all current"':' class="filter-all"',o='<span class="ico-drop"></span>'}else r=a.viewType===g?' class="current"':"",o="",n=f[g].name,s=f[g].url,p=" data-group="+f[g].group;m+="<li"+r+p+' data-url="'+s+'"><span class="title">'+n+"</span>&nbsp;<i></i>"+o+"</li>"}if(l=!this.isOnline&&["allorders","hotelorderlist","flightorderlist"].indexOf(a.viewType)>-1?'<span class="find">查找</span>':"",m+="</ul>"+l+"</div>",this.isOnline||(m='<div style="height:44px">'+m+"</div>"),this.$el.find(".tab-model").remove(),this.$el.prepend(m),this.$el.find(".orders-status-filter li").on("click",function(e){if(!$(this).hasClass("current")){var t="",i=a.bizType||Lizard.P("biztype"),r=Lizard.P("viewtype")||a.viewType;$(e.currentTarget).hasClass("filter-all")||(t="?viewtype="+r+(i?"&biztype="+i:"")),Lizard.jump(Lizard.appBaseUrl+$(e.currentTarget).data("url")+t)}}),this.$el.find(".orders-status-filter .ico-drop").on("click",function(e){u.show(a,e,h),e.stopPropagation()}),this.$el.find(".order-header .find").on("click",function(){if(void 0===a.totalPage||a.totalPage>0){var e=location.href.indexOf("?")>-1?location.href.slice(location.href.indexOf("?")):"";(!e||e.indexOf("searchfrom")<0)&&(e="?searchfrom="+a.viewType),Lizard.jump(Lizard.appBaseUrl+"orders/search"+e)}}),$(window).width()>=768){var T=i.OrderStatusModel.getInstance(),_=[];for(var g in t)_.push({GroupName:g});if(-1===_.length)return;T.setParam("OrderStatisticsGroups",_);var v=this.bizType||Lizard.P("biztype")||"";T.setParam("BizTypes",v),T.excute(function(e){if(e&&e.Result&&0==e.Result.ResultCode&&e.OrderStatisticsGroupList){var t=e.OrderStatisticsGroupList,i=null,r={},n=a.$el.find(".orders-status-filter > li");if(t&&t.length){for(var s=0;s<t.length;s++)i=t[s],i&&i.GroupName&&"undefined"!=typeof i.Count&&parseInt(i.Count,10)>0&&(r[i.GroupName]=parseInt(i.Count,10));r.hasOwnProperty("AwaitPay")&&n.filter('[data-group="AwaitPay"]').find("i").text("("+r.AwaitPay+")"),r.hasOwnProperty("NotTravel")&&n.filter('[data-group="NotTravel"]').find("i").text("("+r.NotTravel+")"),r.hasOwnProperty("AwaitReview")&&n.filter('[data-group="AwaitReview"]').find("i").text("("+r.AwaitReview+")")}}},function(){},!0,this,function(){})}}},_checkLogin:function(){var e=this;if(e.loginStatus=d.checkLogin(),0===e.loginStatus){var t="";r.isInApp||(t=Lizard.P("from")||"",t&&(t="&backurl="+encodeURIComponent(t)));var i={param:this.frompageurl+t};if(r.isInApp){var a=function(t){if(t)e.onShow();else{var i=Lizard.P("from"),a=Lizard.P("from_native_page");1==a?s.backToLastPage():i?/.*(\/webapp\/)(\w*)(\/)(.*)/.test(i)?Lizard.jump(i):s.backToLastPage():s.jump({targetModel:"app",module:"myctrip"})}};i.callback=a}return c.memberLogin(i),!1}return!0},_setTitleNumber:function(e){if(e>0)if(d.isMobile)"searchresult"!==this.viewType&&("uncommentorderlist"===this.viewType||"unpaidorderlist"===this.viewType||"unuseorderlist"===this.viewType?this.header.updateHeader("title",this.title+"（"+e+"）"):this.header.updateHeader("citybtn",this.title+"（"+e+"）"));else for(var t=d.getOrderTypeList(this.isOnline),i="allorders"===this.viewType?"All":this.bizType,a=0,r=t.length;r>a;a++)if(t[a].biztype===i||t[a].biztype instanceof Array){this.$el.find(".order-header .filter-all .title").text(t[a].name+"("+e+")");break}},_getOrderNumberRequestParam:function(e){var t={NotTravel:["vacationunionorderlist","trainorderlist","tuantravelorderlist","busorderlist","flightorderlist","hotelorderlist","carunionorderlist","ticketsorderlist","insureorderlist","cruiseorderlist","localeventorderlist","selftravelorderlist","sceneryhotelorderlist","hhtravelorderlist","allorders","unpaidorderlist","unuseorderlist","uncommentorderlist"],AwaitPay:["vacationunionorderlist","tuanorderlist","busorderlist","trainorderlist","tuantravelorderlist","topshoporderlist","cruiseorderlist","hotelorderlist","travelticketorderlist","insureorderlist","airportbusorderlist","mallorderlist","globalbuyorderlist","localeventorderlist","allorders","unpaidorderlist","unuseorderlist","uncommentorderlist"],AwaitReview:["hotelorderlist","carunionorderlist","ticketsorderlist","localeventorderlist","cruiseorderlist","tuantravelorderlist","allorders","unpaidorderlist","unuseorderlist","uncommentorderlist"]},i={};return this.isOnline&&(t={NotTravel:["vacationunionorderlist","flightorderlist","hotelorderlist","trainorderlist","carunionorderlist","hhtravelorderlist","busorderlist","insureorderlist","localeventorderlist","ticketsorderlist","cruiseorderlist","selftravelorderlist","sceneryhotelorderlist","tuantravelorderlist","allorders","unpaidorderlist","unuseorderlist","uncommentorderlist"],AwaitPay:["vacationunionorderlist","travelticketorderlist","tuanorderlist","trainorderlist","busorderlist","allorders","unpaidorderlist","unuseorderlist","uncommentorderlist","globalbuyorderlist"],AwaitReview:["hotelorderlist","carunionorderlist","tuantravelorderlist","ticketsorderlist","localeventorderlist","allorders","unpaidorderlist","unuseorderlist","uncommentorderlist"]}),t.NotTravel.indexOf(e)>-1&&(i.NotTravel=!0),t.AwaitPay.indexOf(e)>-1&&(i.AwaitPay=!0),t.AwaitReview.indexOf(e)>-1&&(i.AwaitReview=!0),i}});return b}};return m}),define("text!indexTpl_online",[],function(){return'<div class="layoutfix"><div class="main_c"><div class="member-box"><div class="member-info"><div class="member-pic"><i></i><img width="60" data-href="https://sinfo.ctrip.com/MyInfo/AccountCenter/UserInfoUpdate.aspx?v=avapicture" height="60" src="http://pic.c-ctrip.com/h5/rwd_myctrip/portrain_unlogin.png" alt=""></div><div class="member-name" id="memberbox"><i class="i-user" id="ordinary" style="display:none"></i> <i class="i-trophy" id="platinum" style="display:none"></i> <i class="i-gold" id="gold"></i> <span class="member-id" id="username" data-href="https://sinfo.ctrip.com/MyInfo/AccountCenter/UserInfoUpdate.aspx"></span> <a href="https://sinfo.ctrip.com/MyInfo/AccountCenter/UserInfoUpdate.aspx" class="i-edit"></a></div><div class="member-level"><span class="start" id="startlvl">金牌</span><div class="member-level-bar"><div id="progress" style="width:0%" data-href="http://my.ctrip.com/adv/Loyalty/MyGrowup.aspx"><span></span></div></div><span class="end" id="endlvl">白金</span><p id="_basicpoint"></p></div></div><div class="member-message" id="message_centre"><a href="http://my.ctrip.com/home/Message/MessageList.aspx" target="_blank" class="home-mail home-mail-app"><i class="i-mail"></i></a></div></div><ul class="account-box"><li>礼品卡：<a class="f-price" id="_gift" target="_blank" href="https://secure.ctrip.com/Balance-GiftCard/zh-cn/TravelTicket.aspx"></a><a href="http://lipin.ctrip.com/Online/ypbooking/IndexV2.aspx" class="tag-blue">购买</a></li><li>现金：<a class="f-price" id="_merchantbalance" target="_blank" href="https://secure.ctrip.com/Payment-Base-PaymentPwd/Wallet/View/MyWalletIndex.aspx"></a></li><li>返现：<a class="f-price" id="_cash" target="_blank" href="https://sinfo.ctrip.com/Balance/zh-cn/CashAccount.aspx"></a></li><li>积分：<a class="f-blue" id="_point" target="_blank" href="https://sinfo.ctrip.com/MyInfo/AccountCenter/MyMileage.aspx"></a></li><li>优惠券：<a class="f-blue" id="_promocode" target="_blank" href="https://smarket.ctrip.com/Promocode/zh-cn/Promocode.aspx"></a>张</li></ul><ul class="home-tab" id="ordertab"><li data-key="All" class="current">全部订单 <em id="All"></em></li><li data-key="NotTravel">未出行 <em id="NotTravel"></em></li><li data-key="AwaitPay">待付款 <em id="AwaitPay"></em></li><li data-key="AwaitReview">待评价 <em id="AwaitReview"></em></li></ul><ul class="order-list home-order-list" id="orderlist" style="height:310px"></ul><ul class="home-tab"><li class="current">最新收藏</li><li class="more"><a href="http://my.ctrip.com/FavoriteOnline/hotel/hotellist.aspx">更多</a></li></ul><ul class="favorite-list basefix" id="favoritelist" style="height:280px"></ul></div><div class="main_r"><div class="box_widget box_widget_app"><div class="box_widget_inner"><div class="box_widget_tit"><h3>应用中心</h3></div><div class="box_widget_con"><ul class="list_apply basefix"><li><a target="_blank" href="http://my.ctrip.com/adv/Loyalty/MyGrowup.aspx"><i class="ico_apply i_apply_grow"></i>我的成长</a></li><li><a target="_blank" href="http://my.ctrip.com/Home/Order/OrderReviewList.aspx"><i class="ico_apply i_apply_comment"></i>我的点评</a></li><li><a target="_blank" href="http://my.ctrip.com/subscription/Subscribe.aspx"><i class="ico_apply i_apply_rss"></i>邮件订阅</a></li><li><a target="_blank" href="http://my.ctrip.com/Customer-API-Online/MyJourney.aspx"><i class="ico_apply i_apply_route"></i>旅行日程</a></li></ul></div></div></div><div class="box_widget box_widget_bbs"><div class="box_widget_inner"><div class="box_widget_tit"><h3>社区</h3><a target="_blank" href="http://you.ctrip.com/members/" class="more">我的社区主页&nbsp;&gt;</a></div><div class="box_widget_con"><ul class="list_apply basefix"><li><a href="http://you.ctrip.com/events/"><i class="ico_apply i_apply_guide"></i>当地向导</a></li><li><a href="http://you.ctrip.com/asks"><i class="ico_apply i_apply_faqs"></i>攻略问答</a></li><li><a href="http://you.ctrip.com/travels/"><i class="ico_apply i_apply_travels"></i>精选游记</a></li><li><a href="http://you.ctrip.com/dianping/"><i class="ico_apply i_apply_share"></i>分享点评</a></li></ul></div></div></div><div class="box_widget box_widget_privilege"><div class="box_widget_inner"><div class="box_widget_tit"><h3>我的会员特权</h3><a target="_blank" href="http://my.ctrip.com/adv/Loyalty/MyPrivilege.aspx" class="more">更多&nbsp;&gt;</a></div><div class="box_widget_con" id="user_lvl"></div></div></div><div class="box_widget box_widget_member"><div class="box_widget_inner"><div class="box_widget_tit"><h3>会员互动</h3></div><div class="box_widget_con"><ul class="basefix"><li><a target="_blank" href="http://www.ctrip.com/community/senate/activity_index.asp">会员贵宾俱乐部</a></li><li><a target="_blank" href="http://pages.ctrip.com/commerce/promote/201005/other/jfdhzq/index.htm">积分奖励活动专区</a></li></ul></div><div class="divide"></div><div class="box_widget_tit"><h3>会员规则</h3></div><div class="box_widget_con"><ul class="basefix"><li><a target="_blank" href="http://my.ctrip.com/adv/Loyalty/MyLevel.aspx">会员升级标准</a></li><li><a target="_blank" href="http://pages.ctrip.com/commerce/promote/201405/other/jfsd/index.html">携程积分怎么玩儿</a></li></ul></div></div><div class="box_widget_inner widget_bind_weixin"><h5><em>订单贴心提醒，</em>行程一手掌握！</h5><p><i class="ico_mbwx i_mbwx_richscan"></i>扫一扫关联微信，订单有变动，官方微信为您及时提醒</p><i class="ico_mbwx i_mbwx_mobile"></i> <i class="ico_mbwx i_mbwx_qcode"></i></div></div></div></div><div class="recommend-board recommend-board-3"><ul class="basefix"><li class="first"><a target="_blank" href="http://jifen.ctrip.com/rewards/jfhgds/index.aspx"><img src="http://pic.c-ctrip.com/myctripv2/platinum_01_130708.jpg" alt=""></a></li><li><a target="_blank" href="http://pages.ctrip.com/commerce/promote/201306/other/gb/index01.html"><img src="http://pic.c-ctrip.com/myctripv2/pic_diamond_04.jpg" alt=""></a></li><li><a target="_blank" href="http://vacations.ctrip.com/whole-2B126-U-shanghai/?searchValue=%b0%d7%bd%f0%d7%ea%ca%af%b9%f3%b1%f6%d7%a8%cf%ed&searchText=%b0%d7%bd%f0%d7%ea%ca%af%b9%f3%b1%f6%d7%a8%cf%ed"><img src="http://pic.c-ctrip.com/myctripv2/pic_diamond_03.jpg" alt=""></a></li></ul></div>'}),define("orderTypes_h5",["cUtilCommon","MyCtripModel"],function(e){return window.onorientationchange=function(){var e=$("#orderlist-menu");"block"===e.css("display")&&e.find(".cui-select-view").css("max-height",document.body.clientHeight-(isShowSlideMenu?100:50)-(Lizard.isHybrid?0:30))},{append:function(t,i){var a=this,r="",n=null,s="";if(!$("#orderlist-menu").length){r='<div id="orderlist-menu" class="cui-layer" style="display:none;padding:0"><div class="dropdown-group-modal" style="z-index:1001"><div class="dropdown-group-bd"><div class="ordercenter-list"><ul class="cui-select-view" style="overflow:auto;">';for(var o=0,l=i.length;l>o;o++)n=i[o],s=e.isInApp&&"火车票订单"===n.name?'<span class="placeholder">支持12306订单</span>':"",r+='<li class="'+n.classname+'" data-biztype="'+n.biztype+'" data-href="'+n.url+'">'+n.name+"<span></span>"+s+"</li>";r+='</ul></div></div></div></div><div id="orderlist-layer" style="position:fixed;top:0;left:0;z-index:1000;width:100%;height:110%;background-color:rgba(0,0,0,0.6);display:none"></div>',$("body").append(r),$("#orderlist-menu li").on("click",function(e){var t=$(e.currentTarget),i=t.data("href");a.hide(),Lizard.jump(Lizard.appBaseUrl+i)}),$("#orderlist-layer").on("touchmove",function(e){e.preventDefault()}).on("click",a.hide)}},show:function(t,i,a){var r=0,n=isShowSlideMenu||!1,s=s=e.isInApp?n?"50px":"13px":n?"94px":"50px",o=document.body.clientHeight-(n?100:50)-(Lizard.isHybrid?0:30),l=$("#orderlist-layer"),d=$("#orderlist-menu"),c=d.find("li"),p=/\/webapp\/myctrip\/.*(orders\/\w+)/.exec(location.href);if("none"===d.css("display")){if(n){var u=$(i.currentTarget).offset();r=$(i.currentTarget).offset().left-parseInt((320-u.width)/2)-5}else r=(document.body.clientWidth-320)/2;c.removeClass("on"),p&&c.filter('[data-href*="'+p[1]+'"]').addClass("on"),l.show(),d.css({left:r,top:s,display:"block"}).addClass("cm-up-in").find(".cui-select-view").css("max-height",o),setTimeout(function(){d.removeClass("cm-up-in")},300),this._loadData(t,a)}else this.hide()},hide:function(){var e=$("#orderlist-menu"),t=$("#orderlist-layer");t.hide(),e.addClass("cm-up-out"),setTimeout(function(){e.removeClass("cm-up-out").hide()},300)},_loadData:function(e,t){e.bLoadedOrdersCount||t.excute(function(t){if(t&&t.ResponseStatus&&"Success"===t.ResponseStatus.Ack){e.bLoadedOrdersCount=!0;var i={},a=t.OrderNumbers,r=null,n=$("#orderlist-menu li"),s="",o="";if(a&&a.length>0){for(var l=0,d=a.length;d>l;l++)r=a[l],r.BizType&&parseInt(r.OrderNum,10)>0&&(o=r.OrderNum,s=r.BizType,0===s.indexOf("Train")?i.Train=i.Train?i.Train+o:o:i[s]=o);n.each(function(){s=$(this).data("biztype");var e=s.indexOf(",")>-1?!0:!1;if(0==e)i.hasOwnProperty(s)&&$(this).find("span").eq(0).html("（"+i[s]+"）");else{var t=s.split(","),a=0;$.each(t,function(e,t){i.hasOwnProperty(t)&&(a+=i[t])}),$(this).find("span").eq(0).html("（"+a+"）")}})}}},null,!0,e,null)}}}),define("orderTypes_online",["cUtilCommon","MyCtripModel"],function(){return{append:function(e,t){var i=this,a="",r=null;a='<div class="cui-layer" style="display: none;"><div class="dropdown-group-modal"><div class="dropdown-group-bd"><div class="ordercenter-list"><span class="close">×</span><ul class="cui-select-view">';for(var n=0,s=t.length;s>n;n++)r=t[n],a+='<li class="'+r.classname+'" data-biztype="'+r.biztype+'" data-href="'+r.url+'">'+r.name+"<span></span></li>";a+="</ul></div></div></div></div>",e.$el.prepend(a),e.$el.find(".ordercenter-list .close").on("click",function(){i.hide(e)}),e.$el.find(".cui-select-view li").on("click",function(t){var a=$(t.currentTarget),r=a.data("href"),n=a.html(),s=/(.*)\<(\w+)\>.*\<\/\2\>/.exec(n);s&&(n=s[1]),i.hide(e),Lizard.jump(Lizard.appBaseUrl+r)})},show:function(e,t,i){var a=e.$el.find(".cui-layer");"none"===a.css("display")?(a.css({left:0,top:"50px",display:"block"}),this._loadData(e,i)):this.hide(e)},hide:function(e){e.$el.find(".cui-layer").hide()},_loadData:function(e,t){e.bLoadedOrdersCount||(e.bLoadedOrdersCount=!0,t.excute(function(t){if(t&&t.ResponseStatus&&"Success"===t.ResponseStatus.Ack){var i={},a=t.OrderNumbers,r=null,n=e.$el.find(".cui-select-view li"),s="",o="";if(a&&a.length>0){for(var l=0,d=a.length;d>l;l++)r=a[l],r.BizType&&parseInt(r.OrderNum,10)>0&&(o=r.OrderNum,s=r.BizType,0===s.indexOf("Train")?i.Train=i.Train?i.Train+o:o:i[s]=o);n.each(function(){s=$(this).data("biztype"),i.hasOwnProperty(s)&&$(this).find("span").eq(0).html("（"+i[s]+"）")})}}},null,!0,e,null))}}}),define("pagination_online",[],function(){return $.fn.pagination=function(e,t){return t=$.extend({items_per_page:10,num_display_entries:10,current_page:0,num_edge_entries:0,link_to:"",prev_text:"Prev",next_text:"Next",ellipse_text:"...",prev_show_always:!0,next_show_always:!0,callback:function(){return!1}},t||{}),this.each(function(){function i(){return Math.ceil(e/t.items_per_page)}function a(){var e=Math.ceil(t.num_display_entries/2),a=i(),r=a-t.num_display_entries,n=s>e?Math.max(Math.min(s-e,r),0):0,o=s>e?Math.min(s+e,a):Math.min(t.num_display_entries,a);return[n,o]}function r(e,i){if(s=e,n(),t.callback(e,o),window.scrollTo(0,0),i){if(i.stopPropagation?i.stopPropagation():i.cancelBubble=!0,!i.preventDefault)return!1;i.preventDefault()}}function n(){var e=$('<div class="number_box"></div>');o.empty();var n=a(),l=i(),d=function(e){return function(t){return r(e,t)}},c=function(i,a){if(i=0>i?0:l>i?i:l-1,a=$.extend({text:i+1},a||{}),i==s)var r=$("<a href='javascript:void(0)' class='current'>"+a.text+"</a>");else var r=$("<a>"+a.text+"</a>").bind("click",d(i)).attr("href",t.link_to.replace(/__id__/,i));if(a.classes)if(r.removeAttr("class"),r.addClass(a.classes),"disabled"==a.classes||""==a.classes){var n=$('<i class="prev"></i>');r.append(n)}else if("next"==a.classes||"next disabled"==a.classes){var n=$("<i></i>");r.append(n)}e.append(r)};if(0==s||t.prev_show_always){var p="";p=0==s?"disabled":"",c(s-1,{text:t.prev_text,classes:p})}if(n[0]>0&&t.num_edge_entries>0){for(var u=Math.min(t.num_edge_entries,n[0]),f=0;u>f;f++)c(f);t.num_edge_entries<n[0]&&t.ellipse_text&&e.append($("<span>"+t.ellipse_text+"</span>"))}for(var f=n[0];f<n[1];f++)c(f);if(n[1]<l&&t.num_edge_entries>0){l-t.num_edge_entries>n[1]&&t.ellipse_text&&e.append($("<span>"+t.ellipse_text+"</span>"));for(var h=Math.max(l-t.num_edge_entries,n[1]),f=h;l>f;f++)c(f)}if(t.next_text&&(l-1>s||t.next_show_always)){var m="";m=s>=l-1?"next disabled":"next",c(s+1,{text:t.next_text,classes:m})}var g=$('<div class="sel_box">到 <input type="text" value="'+(s+1)+'"> 页 <button type="button">确定</button></div>');$('<div class="paging"></div>').append(e).append(g).appendTo(o);var y=t.view?t.view.$el.find(".sel_box button"):$(".sel_box button");y.on("click",function(){var e=$(this).parent().find("input").val(),t=/\D/g;return t.test(e)?void alert("输入页码有误，请重新输入。"):e>0&&e<=i()?void r(Number(e)-1,null):void alert("输入页码有误，请重新输入。")}),o.find("a").eq(0).html("<i></i>")}var s=t.current_page;e=!e||0>e?1:e,t.items_per_page=!t.items_per_page||t.items_per_page<0?1:t.items_per_page;var o=$(this);this.selectPage=function(e){r(e)},this.prevPage=function(){return s>0?(r(s-1),!0):!1},this.nextPage=function(){return s<i()-1?(r(s+1),!0):!1},o.empty(),n()})},$});