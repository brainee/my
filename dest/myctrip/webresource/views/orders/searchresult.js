define(["commonlist","MyCtripModel","cUtilCommon"],function(e,t){return e.getInstance({pageid:"",bizType:"",viewType:"searchresult",listModel:null,queries:[],byId:!1,bCustomizeHead:!0,onShow:function(e){e.getQueries(e),e.byId="true"==e.queries.byid?!0:!1,e.orderId=e.queries.orderid;var r=e.queries.searchfrom,l=e.queries.type,i=e.queries.status;switch(e.listModel=t.OrdersSearchModel.getInstance(),e.listModel.param={Channel:e.listModel.param.Channel,ClientVersion:e.listModel.param.ClientVersion,OrderStatusClassify:"All",PageIndex:1},r){case"allorders":break;case"hotelorderlist":e.byId||("HotelDomestic"==l?e.listModel.setParam("OrderTypes",["Domestic"]):"HotelInternational"==l?e.listModel.setParam("OrderTypes",["International"]):"HotelMask"==l&&e.listModel.setParam("OrderTypes",["Mask"])),e.bizType="Hotel";break;case"flightorderlist":e.byId||("FlightDomestic"==l?e.listModel.setParam("OrderTypes",["Domestic"]):"FlightInternational"==l&&e.listModel.setParam("OrderTypes",["International"])),e.bizType="Flight";break;default:r="allorders"}e.frompageurl=Lizard.appBaseUrl+"orders/searchresult?searchfrom="+r,e._showHead("查找结果"),e.byId?e.orderId?(e.listModel.setParam("OrderIDs",e.orderId),"allorders"==r&&e.listModel.setParam("TimeScope",0),e.frompageurl+=",byid=true,orderid="+e.orderId):e.frompageurl+=",byid=false":(e.frompageurl+=",byid=false"+(l?",type="+l:"")+(i?",status="+i:""),i&&e.listModel.setParam("OrderStatuses",i)),e.frompageurl="from="+encodeURIComponent(e.frompageurl);var s=e.queries.flag;return"orders/search"==e.referrer&&"nocache"==s?!0:void 0},onHide:function(e){delete e.listModel.param.OrderTypes,delete e.listModel.param.TimeScope,delete e.listModel.param.BookingDateTime,delete e.listModel.param.OrderStatuses,delete e.listModel.param.OrderStatusClassify,delete e.listModel.param.OrderIDs},onAfterRequest:function(e,t,r){if(r&&e.elsBox.lstbox.empty(),t&&t.Result&&0==t.Result.ResultCode){r&&t.TotalCount>0&&e._showHead("查找结果（"+t.TotalCount+"）");var l=t[e.entityName];if(l){e.byId&&e.orderId&&(l=l.slice(0,1),t[e.entityName]=l);for(var i="OrderEnities"==e.entityName?!0:!1,s=0,a=l.length;a>s;s++)l[s].bAllSearch=i}}else t&&t.Result&&(-1==t.Result.ResultCode||-2==t.Result.ResultCode)&&(e.$el.removeClass("order-bg"),e.elsBox.lstbox.append('<div class="search-noresult"><i class="i-search-noresult"></i><p>暂时没有相关订单，请修改条件重新查找</p></div>'))},onError:function(e,t,r,l){l&&e.elsBox.lstbox.empty()},_showHead:function(e){var t=this;this.isOnline||t.headerview.set({title:e,back:!0,view:t,events:{returnHandler:function(){var e=Lizard.appBaseUrl,r=t.queries.searchfrom;("allorders"==r||"hotelorderlist"==r||"flightorderlist"==r)&&(e+="orders/"+r),Lizard.goTo(e)}}})},getQueries:function(e){var t={uncommitted:"Uncommitted",waitpay:"WaitPay",dealt:"Dealt",returnticket:"ReturnTicket",hoteldomestic:"HotelDomestic",hotelinternational:"HotelInternational",hotelmask:"HotelMask",uncommit:"Uncommit",confirming:"Confirming",confirmed:"Confirmed",completed:"Completed",cancelled:"Cancelled",flightdomestic:"FlightDomestic",flightinternational:"FlightInternational",ticketing:"Ticketing",ticketed:"Ticketed",unsubcribepart:"UnsubcribePart",unsubcribeall:"UnsubcribeAll",cancelling:"Cancelling"},r=location.href.slice(location.href.indexOf("?")+1),l=r.replace("&",",").split(","),i="";e.queries=[];for(var s=0,a=l.length;a>s;s++){i=l[s];var o=i.split("="),d="",n="";2===o.length&&(d=o[0].toLowerCase(),n=o[1],e.queries[d]=t[n]?t[n]:n)}}})});