define(["commonlist","cUtilCommon","cGuiderService","myctripCommon","CommonStore"],function(e,i,n,t){return e.getInstance({pageid:"231032",hpageid:"231032",viewType:"allorders",unionType:"All",title:"全部订单",bOffline:!1,bLogin:!1,bNoNeedCheckLogin:!1,Guider:n,onShow:function(e){e.bLogin=1===t.checkLogin(),e.bOffline="offline"===Lizard.P("from")?!0:!1,e.bNoNeedCheckLogin=e.bOffline&&!e.bLogin,e.nologinAndOnline=!1,i.isInApp&&e.Guider.app_check_network_status({callback:function(i){i&&i.hasNetwork?e.bLogin?e.bOffline=!1:(e.nologinAndOnline=!0,e._checkLogin()):e.bOffline=!0}})},showView:function(e){if(i.isInApp){var n=1==localStorage.getItem("TRAIN_TIP_SHOWED");if(!n){var t=0,o=isShowSlideMenu?50:8;trainTips=$('<div class="order-tips">火车票订单列表中可以查询12306订单啦</div>'),e.$el.prepend(trainTips),isShowSlideMenu?t="15px":(trainTips.css("left","0"),t=(document.body.clientWidth-trainTips.width())/2),trainTips.css({left:t,top:o}),setTimeout(function(){trainTips.remove()},2e3),localStorage.setItem("TRAIN_TIP_SHOWED",1)}}},onTopPulling:function(){this.bLogin&&(this.$el.find(".top-tips").remove(),this.$el.find(".order-wrap").css("margin-top",0))},onAfterRequest:function(e,n,t){n&&n.Result&&0==n.Result.ResultCode&&(i.isInApp&&t&&e.writeOfflineData(e,n),isShowSlideMenu&&(e._showPadHead(),e.$el.find(".order-header").parent().show()))},onAfterRender:function(e){return e.bOffline?!0:void 0},onError:function(e){return e.nologinAndOnline?!0:i.isInApp?(e.offlineOperate(e),!0):void 0},offlineOperate:function(e){e.bLogin?e.tipContent="网络不给力，当前订单状态及价格可能不是最新。若需查询最新订单数据，请检查网络后重试。":(e.tipContent="网络不给力，当前订单状态及价格可能不是最新。若需查询最新订单数据，或非会员订单，请检查网络后重试。",e.headerview.set({title:"离线订单",back:!0,view:e,events:{returnHandler:function(){e.Guider.apply({callback:function(){e.jump("/webapp/myctrip/")},hybridCallback:function(){e.Guider.jump({targetModel:"app",module:"myctrip"})}})}}}),e.headerview.show()),isShowSlideMenu&&e.$el.find(".order-header").parent().hide(),e.bNoMore=!0,e.readOfflineData(e),e.bTopPulling=!1,e.endPull()},writeOfflineData:function(e,i){var n="myctrip_offlineorder.txt",t={fileName:n,relativeFilePath:null,text:JSON.stringify(i),isAppend:!1,callback:function(){}};e.Guider.file.writeTextToFile(t)},readOfflineData:function(e){var i="myctrip_offlineorder.txt",n={fileName:i,relativeFilePath:null,callback:function(i){return i&&i.text&&(i=JSON.parse(i.text),e.filterOfflineData(e,i))?(e.totalPage=1,e.elsBox.lstbox.html(""),void e.renderList(i,!0)):(e.totalPage=0,void e.elsBox.lstbox.html('<div class="cui-load-error">您没有离线订单</div>'))}};e.Guider.file.readTextFromFile(n)},filterOfflineData:function(e,i){var n=null;if(i&&i.Result&&0==i.Result.ResultCode&&(n=i.OrderEnities,n&&n.length)){if(!e.bLogin)for(var t=0,o=n.length;o>t;t++)n[t].OrderActions&&(n[t].OrderActions=[],n[t].isOfflineOrder=!0);return!0}return!1}})});